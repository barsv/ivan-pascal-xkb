<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head><script src="//archive.org/includes/analytics.js?v=cf34f82" type="text/javascript"></script>
<script type="text/javascript">window.addEventListener('DOMContentLoaded',function(){var v=archive_analytics.values;v.service='wb';v.server_name='wwwb-app204.us.archive.org';v.server_ms=348;archive_analytics.send_pageview({});});</script>
<script type="text/javascript" src="/_static/js/bundle-playback.js?v=KTqwAcYd" charset="utf-8"></script>
<script type="text/javascript" src="/_static/js/wombat.js?v=UHAOicsW" charset="utf-8"></script>
<script type="text/javascript">
  __wm.init("https://web.archive.org/web");
  __wm.wombat("http://pascal.tsu.ru:80/en/xkb/internals.html","20190718184358","https://web.archive.org/","web","/_static/",
	      "1563475438");
</script>
<link rel="stylesheet" type="text/css" href="/_static/css/banner-styles.css?v=fantwOh2" />
<link rel="stylesheet" type="text/css" href="/_static/css/iconochive.css?v=qtvMKcIJ" />
<!-- End Wayback Rewrite JS Include -->

<meta http-equiv="Content-Type" content="text/html; charset=windows-1251"/>
<title>Ivan Pascal (Homepage)</title>
<style type="text/css" media="all">@import url(/web/20190718184358cs_/http://pascal.tsu.ru/css/style.css);</style>
</head>
<body><!-- BEGIN WAYBACK TOOLBAR INSERT -->
<style type="text/css">
body {
  margin-top:0 !important;
  padding-top:0 !important;
  /*min-width:800px !important;*/
}
</style>
<script>__wm.rw(0);</script>
<div id="wm-ipp-base" lang="en" style="display:none;direction:ltr;">
<div id="wm-ipp" style="position:fixed;left:0;top:0;right:0;">
<div id="donato" style="position:relative;width:100%;">
  <div id="donato-base">
    <iframe id="donato-if" src="https://archive.org/includes/donate.php?as_page=1&amp;platform=wb&amp;referer=https%3A//web.archive.org/web/20190718184358/http%3A//pascal.tsu.ru/en/xkb/internals.html"
	    scrolling="no" frameborder="0" style="width:100%; height:100%">
    </iframe>
  </div>
</div><div id="wm-ipp-inside">
  <div id="wm-toolbar" style="position:relative;display:flex;flex-flow:row nowrap;justify-content:space-between;">
    <div id="wm-logo" style="/*width:110px;*/padding-top:12px;">
      <a href="/web/" title="Wayback Machine home page"><img src="/_static/images/toolbar/wayback-toolbar-logo-200.png" srcset="/_static/images/toolbar/wayback-toolbar-logo-100.png, /_static/images/toolbar/wayback-toolbar-logo-150.png 1.5x, /_static/images/toolbar/wayback-toolbar-logo-200.png 2x" alt="Wayback Machine" style="width:100px" border="0" /></a>
    </div>
    <div class="c" style="display:flex;flex-flow:column nowrap;justify-content:space-between;flex:1;">
      <form class="u" style="display:flex;flex-direction:row;flex-wrap:nowrap;" target="_top" method="get" action="/web/submit" name="wmtb" id="wmtb"><input type="text" name="url" id="wmtbURL" value="http://pascal.tsu.ru/en/xkb/internals.html" onfocus="this.focus();this.select();" style="flex:1;"/><input type="hidden" name="type" value="replay" /><input type="hidden" name="date" value="20190718184358" /><input type="submit" value="Go" />
      </form>
      <div style="display:flex;flex-flow:row nowrap;align-items:flex-end;">
		<div class="s" id="wm-nav-captures" style="flex:1;">
	  	  <a class="t" href="/web/20190718184358*/http://pascal.tsu.ru/en/xkb/internals.html" title="See a list of every capture for this URL">52 captures</a>
	  <div class="r" title="Timespan for captures of this URL">16 Aug 2004 - 23 Aug 2019</div>
	  </div>
	<div class="k">
	  <a href="" id="wm-graph-anchor">
	    <div id="wm-ipp-sparkline" title="Explore captures for this URL" style="position: relative">
	      <canvas id="wm-sparkline-canvas" width="675" height="27" border="0"></canvas>
	    </div>
	  </a>
	</div>
      </div>
    </div>
    <div class="n">
      <table>
	<tbody>
	  <!-- NEXT/PREV MONTH NAV AND MONTH INDICATOR -->
	  <tr class="m">
	    <td class="b" nowrap="nowrap"><a href="https://web.archive.org/web/20190611134641/http://pascal.tsu.ru:80/en/xkb/internals.html" title="11 Jun 2019"><strong>Jun</strong></a></td>
	    <td class="c" id="displayMonthEl" title="You are here: 18:43:58 Jul 18, 2019">JUL</td>
	    <td class="f" nowrap="nowrap"><a href="https://web.archive.org/web/20190823072427/http://pascal.tsu.ru:80/en/xkb/internals.html" title="23 Aug 2019"><strong>Aug</strong></a></td>
	  </tr>
	  <!-- NEXT/PREV CAPTURE NAV AND DAY OF MONTH INDICATOR -->
	  <tr class="d">
	    <td class="b" nowrap="nowrap"><a href="https://web.archive.org/web/20190611134641/http://pascal.tsu.ru:80/en/xkb/internals.html" title="13:46:41 Jun 11, 2019"><img src="/_static/images/toolbar/wm_tb_prv_on.png" alt="Previous capture" width="14" height="16" border="0" /></a></td>
	    <td class="c" id="displayDayEl" style="width:34px;font-size:22px;white-space:nowrap;" title="You are here: 18:43:58 Jul 18, 2019">18</td>
	    <td class="f" nowrap="nowrap"><a href="https://web.archive.org/web/20190823072427/http://pascal.tsu.ru:80/en/xkb/internals.html" title="07:24:27 Aug 23, 2019"><img src="/_static/images/toolbar/wm_tb_nxt_on.png" alt="Next capture" width="14" height="16" border="0" /></a></td>
	  </tr>
	  <!-- NEXT/PREV YEAR NAV AND YEAR INDICATOR -->
	  <tr class="y">
	    <td class="b" nowrap="nowrap"><a href="https://web.archive.org/web/20171214212322/http://pascal.tsu.ru:80/en/xkb/internals.html" title="14 Dec 2017"><strong>2017</strong></a></td>
	    <td class="c" id="displayYearEl" title="You are here: 18:43:58 Jul 18, 2019">2019</td>
	    <td class="f" nowrap="nowrap">2020</td>
	  </tr>
	</tbody>
      </table>
    </div>
    <div class="r" style="display:flex;flex-flow:column nowrap;align-items:flex-end;justify-content:space-between;">
      <div id="wm-btns" style="text-align:right;height:23px;">
        	<span class="xxs">
          <div id="wm-save-snapshot-success">success</div>
          <div id="wm-save-snapshot-fail">fail</div>
          <a id="wm-save-snapshot-open" href="#"
	     title="Share via My Web Archive" >
            <span class="iconochive-web"></span>
          </a>
          <a href="https://archive.org/account/login.php" title="Sign In" id="wm-sign-in">
            <span class="iconochive-person"></span>
          </a>
          <span id="wm-save-snapshot-in-progress" class="iconochive-web"></span>
	</span>
        	<a class="xxs" href="http://faq.web.archive.org/" title="Get some help using the Wayback Machine" style="top:-6px;"><span class="iconochive-question" style="color:rgb(87,186,244);font-size:160%;"></span></a>
	<a id="wm-tb-close" href="#close" style="top:-2px;" title="Close the toolbar"><span class="iconochive-remove-circle" style="color:#888888;font-size:240%;"></span></a>
      </div>
      <div id="wm-share" class="xxs">
        <a href="/web/20190718184358/http://web.archive.org/screenshot/http://pascal.tsu.ru/en/xkb/internals.html"
           id="wm-screenshot"
           title="screenshot">
          <span class="wm-icon-screen-shot"></span>
        </a>
        <a href="#" id="wm-video" title="video">
          <span class="iconochive-movies"></span>
        </a>
	<a id="wm-share-facebook" href="#" data-url="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru:80/en/xkb/internals.html" title="Share on Facebook" style="margin-right:5px;" target="_blank"><span class="iconochive-facebook" style="color:#3b5998;font-size:160%;"></span></a>
	<a id="wm-share-twitter" href="#" data-url="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru:80/en/xkb/internals.html" title="Share on Twitter" style="margin-right:5px;" target="_blank"><span class="iconochive-twitter" style="color:#1dcaff;font-size:160%;"></span></a>
      </div>
      <div style="padding-right:2px;text-align:right;white-space:nowrap;">
	<a id="wm-expand" class="wm-btn wm-closed" href="#expand" onclick="__wm.ex(event);return false;"><span id="wm-expand-icon" class="iconochive-down-solid"></span> <span class="xxs" style="font-size:80%;">About this capture</span></a>
      </div>
    </div>
  </div>
    <div id="wm-capinfo" style="border-top:1px solid #777;display:none; overflow: hidden">
                    <div id="wm-capinfo-collected-by">
    <div style="background-color:#666;color:#fff;font-weight:bold;text-align:center">COLLECTED BY</div>
    <div style="padding:3px;position:relative" id="wm-collected-by-content">
            <div style="display:inline-block;vertical-align:top;width:50%;">
			<span class="c-logo" style="background-image:url(https://archive.org/services/img/alexacrawls);"></span>
		Organization: <a style="color:#33f;" href="https://archive.org/details/alexacrawls" target="_new"><span class="wm-title">Alexa Crawls</span></a>
		<div style="max-height:75px;overflow:hidden;position:relative;">
	  <div style="position:absolute;top:0;left:0;width:100%;height:75px;background:linear-gradient(to bottom,rgba(255,255,255,0) 0%,rgba(255,255,255,0) 90%,rgba(255,255,255,255) 100%);"></div>
	  Starting in 1996, <a href="http://www.alexa.com/">Alexa Internet</a> has been donating their crawl data to the Internet Archive.  Flowing in every day, these data are added to the <a href="http://web.archive.org/">Wayback Machine</a> after an embargo period.
	</div>
	      </div>
      <div style="display:inline-block;vertical-align:top;width:49%;">
			<span class="c-logo" style="background-image:url(https://archive.org/services/img/alexacrawls)"></span>
		<div>Collection: <a style="color:#33f;" href="https://archive.org/details/alexacrawls" target="_new"><span class="wm-title">Alexa Crawls</span></a></div>
		<div style="max-height:75px;overflow:hidden;position:relative;">
	  <div style="position:absolute;top:0;left:0;width:100%;height:75px;background:linear-gradient(to bottom,rgba(255,255,255,0) 0%,rgba(255,255,255,0) 90%,rgba(255,255,255,255) 100%);"></div>
	  Starting in 1996, <a href="http://www.alexa.com/">Alexa Internet</a> has been donating their crawl data to the Internet Archive.  Flowing in every day, these data are added to the <a href="http://web.archive.org/">Wayback Machine</a> after an embargo period.
	</div>
	      </div>
    </div>
    </div>
    <div id="wm-capinfo-timestamps">
    <div style="background-color:#666;color:#fff;font-weight:bold;text-align:center" title="Timestamps for the elements of this page">TIMESTAMPS</div>
    <div>
      <div id="wm-capresources" style="margin:0 5px 5px 5px;max-height:250px;overflow-y:scroll !important"></div>
      <div id="wm-capresources-loading" style="text-align:left;margin:0 20px 5px 5px;display:none"><img src="/_static/images/loading.gif" alt="loading" /></div>
    </div>
    </div>
  </div></div></div></div><div id="wm-ipp-print">The Wayback Machine - https://web.archive.org/web/20190718184358/http://pascal.tsu.ru:80/en/xkb/internals.html</div>
<script type="text/javascript">//<![CDATA[
__wm.bt(675,27,25,2,"web","http://pascal.tsu.ru/en/xkb/internals.html","20190718184358",1996,"/_static/",["/_static/css/banner-styles.css?v=fantwOh2","/_static/css/iconochive.css?v=qtvMKcIJ"], false);
  __wm.rw(1);
//]]></script>
<!-- END WAYBACK TOOLBAR INSERT -->

<div style="position:absolute; top:10; right:0; z-index:3"><img src="/web/20190718184358im_/http://pascal.tsu.ru/img/logo.jpg"/>
<div style=" font-size:11px;">
<a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/en/">ENGLISH</a> | 
<a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/">KOI</a> | 
<a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/win/">WIN</a> | 
<a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/alt/">ALT</a> | 
<a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/iso/">ISO</a></div>
</div>

<div id="head"><h2>Иван Паскаль</h2>
<div class="anotation">
Этот сайт посвящен описанию Операционной Системы
<noindex><a href="https://web.archive.org/web/20190718184358/http://www.freebsd.org/">FreeBSD</a></noindex> (одна из разновидностей Unix). 
<br/>
Я его сделал для того, чтобы хоть немного восполнить недостаток
документации, особенно на русском языке.<a href="unix"> Полная "Table of Contents"</a>
</p>
</div>
</div>


<table width="100%">
<tr>
<td width="300" valign="top">

<div id="block">
<div class="title"><a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/unix/add/adding.html">Добавление компонент из дистрибутива</a></div>
	<ul>
		<li><a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/unix/add/packages.html">Установка "пакетов" (packages)</a></li>
		<li><a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/unix/add/ports.html">Установка "портов" (ports)</a></li>
		<li><a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/unix/add/sysinst.html">С помощью программы sysinstall</a></li>
		<li><a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/unix/add/manualy.html">Установка "вручную"</a></li>
	</ul>
</div>
<div id="block">
<div class="title"><a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/unix/users/users0.html">Работа администратора с user account</a></div>
<ul>
  <li> <a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/unix/users/users1.html">Что такое &quot;учетная карточка&quot;?</a> </li>
  <li> <a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/unix/users/users2.html">Что  хранится в учетной карточке?</a> </li>
  <li> <a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/unix/users/users3.html">Для чего используется учетная карточка?</a> </li>
  <li> <a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/unix/users/users4.html">Где хранятся учетные карточки?</a> </li>
  <li> <a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/unix/users/users5.html">Добавление пользователя</a></li>
  <li> <a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/unix/users/users6.html">Редактирование данных учетной карточки?</a> </li>
  <li> <a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/unix/users/users7.html">Удаление пользователя</a></li>
  <li> <a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/unix/users/users8.html">Права пользователя на учетную карточку</a></li>
  <li> <a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/unix/users/users9.html">Временная блокировка пользователя</a></li>
  <li> <a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/unix/users/users10.html">Что еще почитать?</a> </li>
</ul>
</div>
<div id="block">
<div class="title"><a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/unix/users/groups.html">Группы (пользователей)</a></div>
<ul>
  <li> <a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/unix/users/groups1.html">Что такое группа?</a> </li>
  <li> <a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/unix/users/groups2.html">Где хранится информация о группах?</a> </li>
  <li> <a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/unix/users/groups3.html">Колличество групп, юзеров в группе, групп у юзера</a></li>
  <li> <a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/unix/users/groups4.html">Как создать или удалить группу?</a> </li>
  <li> <a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/unix/users/groups5.html">Редактирование принадлежности юзера к группе</a> </li>
</ul>
</div>
<div id="block">
<div class="title"><a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/unix/files/files1.html">Права доступа к файлам</a></div>
<ul>
	<li><a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/unix/files/files2.html">Какие атрибуты файла определяют &quot;право доступа&quot;.</a></li>
	<li><a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/unix/files/files3.html">Основные биты доступа (чтение/запись/выполнение)</a> </li>
	<li><a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/unix/files/files4.html">Дополнительные биты доступа</a> </li>
	<li><a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/unix/files/files5.html">&quot;Странные&quot; сочетания битов доступа.</a> </li>
	<li><a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/unix/files/files6.html">Флаги.</a> </li>
	<li><a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/unix/files/files7.html">С какими правами файл &quot;рождается&quot;</a> </li>
	<li><a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/unix/files/files7a.html">Права после копирования или перемещения</a></li>
	<li><a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/unix/files/files8.html">Как поменять права </a></li>
	<li><a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/unix/files/files9.html">Что делать если этого не хватает?</a> </li>
</ul>
</div>
<div id="block">
<div class="title"><a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/unix/syscons/syscons.html">Драйвер "системной консоли" - syscons</a></div>
<ul>
  <li><a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/unix/syscons/main.html">Основные возможности syscons</a> </li>
  <li><a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/unix/syscons/screen.html">Дисплей</a> </li>
  <li><a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/unix/syscons/keyboard.html">Клавиатура</a> </li>
  <li><a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/unix/syscons/kbd-examples.html">Примеры изменения назначения клавиш.</a> </li>
  <li><a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/unix/syscons/vidcontrol.html">Программа vidcontrol</a> </li>
  <li><a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/unix/syscons/kbdcontrol.html">Программа kbdcontrol</a> </li>
  <li><a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/unix/syscons/russian.html">Русификация syscons</a> </li>
  <li><a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/unix/syscons/termcap.html">&quot;Взаимопонимание&quot; программ с терминалом </a></li>
  <li><a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/unix/syscons/XWin.html"> Какое отношение это имеет к X-Window?</a> </li>
  <li><a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/unix/syscons/ansi.html">Команды (esc-последовательности) syscons</a> </li>
  <li><a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/unix/syscons/app2.html">Управляющие (&quot;контроловые&quot;) символы</a> </li>
  <li><a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/unix/syscons/app3.html">&quot;Функциональные&quot; клавиши</a> </li>
  <li><a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/unix/syscons/app4.html">Несколько мелких полезных программок.</a> </li>
</ul>
</div>
<div id="block">
<div class="title">Разное</div>
<ul>
	<li><a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/unix/lint/rebuild.html">Перегенерация ядра системы (kernel)</a></li>
	<li><a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/other/frames.html">Фреймы Ethernet.</a></li>
	<li><a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/other/xkb/">XKB - "клавиатурный модуль" X-Window.</a></li>
</ul>
</div>
<div id="block">
<div class="title">Мои программы</div>
<ul>
	<li><a href="other/xxkb/">Xxkb</a> (для модуля XKB)</li>
	<li><a href="other/xxkb/README">README</a> и <a href="other/xxkb/CHANGES">CHANGES</a>.</li>
</ul>
</div>
</td>

<td class="content" valign="top" align="left"><h2>Some words about XKB internals.</h2>
  <ul>
    <li><a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/en/xkb/internals.html#codes">The basic terms - codes and symbols.</a> </li>
    <li><a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/en/xkb/internals.html#two-part">Two parts of XKB and compatibility problem.</a> </li>
    <li><a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/en/xkb/internals.html#symbols">Symbols table.</a> </li>
    <li><a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/en/xkb/internals.html#actions">Actions table.</a> </li>
    <li><a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/en/xkb/internals.html#state-group">XKB state: current group number.</a> </li>
    <li><a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/en/xkb/internals.html#wrap">&quot;Keeping in range&quot; methods for group number.</a> </li>
    <li><a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/en/xkb/internals.html#mods">Modifiers.</a> </li>
    <li><a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/en/xkb/internals.html#state-mods">XKB state: current modifiers set.</a> </li>
    <li><a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/en/xkb/internals.html#types">Shift level calculation. Key types.</a> </li>
    <li><a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/en/xkb/internals.html#key">What other data each keycode description has.</a>
        <ul>
          <li><a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/en/xkb/internals.html#key-wrap">Keep group number in range method.</a> </li>
          <li><a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/en/xkb/internals.html#key-behavior">Key behavior.</a> </li>
          <li><a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/en/xkb/internals.html#key-explicit">Exceptions set.</a> </li>
          <li><a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/en/xkb/internals.html#key-mods">Real and virtual modifiers.</a> </li>
        </ul>
    </li>
    <li><a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/en/xkb/internals.html#controls">XKB state: control flags (XKB Controls).</a> </li>
    <li><a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/en/xkb/internals.html#indicators">Indicators.</a> </li>
    <li><a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/en/xkb/internals.html#compat">Compatibility table.</a> </li>
    <li><a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/en/xkb/internals.html#radio">Radio Groups</a> </li>
    <li><a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/en/xkb/internals.html#overlay">Overlays.</a> </li>
    <li><a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/en/xkb/internals.html#accessx">AccessX. Additional services for physically               impaired persons.</a> </li>
    <li><a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/en/xkb/internals.html#mouse">Mouse events emulation.</a> </li>
    <li><a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/en/xkb/internals.html#bell">Bell features extension.</a> </li>
  </ul>
  <h3><a name="codes" id="codes">The basic terms - codes and symbols.</a></h3>
  <p> The main XKB module function is convertion of the pressed keys scan-codes  to the symbol codes. </p>
  <p> In the XKB documentation scan-codes are named <strong>keycodes</strong> and the  symbols codes are named simply <strong>symbols</strong>. </p>
  <p> Of course the &quot;symbols&quot; term doesn't mean printable symbol codes only  (letters, digits, punctuation, etc.). This term includes &quot;control symbols&quot;  (such as Esc, Enter, Backspace, etc.) and codes that can influence to  state of XKB itself and so to other symbols choice procedure   (alphabet switcher, Control, Shift, Alt, etc.). </p>
  <h3><a name="two-part" id="two-part">Two parts of XKB and compatibility problem.</a></h3>
  <p> First of all I should tell some words how scan-codes to symbols conversion  occurs in the X Window System without XKB module. </p>
  <p> The X-server itself doesn't converts keycode to symbol.    When you press or release any key X-server keyboard module sends  &quot;message about event&quot; (or simply <strong>event</strong>) to application. </p>
  <p> Such message contains scan-code and &quot;keyboard state&quot; only.    The keyboard state is bit flags set that reflects the state of  &quot;modifer keys&quot; - <strong>Shift, Control, Alt, CapsLock</strong>, etc. </p>
  <p> So namely application has to decide what symbol match to this scan-code  when such modifiers are set. </p>
  <p> Of course for this purpose application can use &quot;keyboard map table&quot; stored  in the X-server that contain lists of all possible symbols for each scan-code.  Usually application gets this table from the X-server at start time. </p>
  <p> Of course nobody writes such scan-code interpretation procedure for each  application. There are special subroutines for this purpose in Xlib  library. <br/>
    Remind that the Xlib is set of low-level procedures for communication  between application and the X-server. And even application use only hight-level  library or toolkit (such as Xaw, Motif, Qt, gtk, etc.) this library in  its own turn use Xlib as base. </p>
  <p> So Xlib procedures knowing scan-code and modifiers state from event message  choose appropriate symbol from keyboard map table derived from server  at startup. </p>
  <p> And the XKB module too sends to application scan-code and own state only.    But unlike old module XKB have more complicated symbols table,  different modifiers set and some other components of keyboard state. </p>
  <p> Therefore for right working Xlib must contain procedures that are &quot;XKB aware&quot;.  Of course X's that have server with XKB module also has XKB-aware Xlib. </p>
  <p> So we can say that the XKB consists of two parts - module built in server  and Xlib subroutines set that are part of each application. </p>
  <p> But nobody forbids to use applications that was linked with old Xlib that  doesn't know about XKB. It leads to &quot;compatibility problem&quot;.    XKB must be able to communicate with own Xlib and with old &quot;non XKB-aware&quot;  Xlib too. <br/>
    Of course such communication is not limited with messages about  key press or release. Xlib procedures can send to X-server some  requests (for example get symbols map) and commands (for example change  some symbol placement in this table). <br/>
    And even working with old Xlib XKB must react to such requests and commands  to allow application work as correctly as possible. </p>
  <h3><a name="symbols" id="symbols">Symbols table.</a></h3>
  <p> What is simbols table that binds symbols with keycodes and modifiers state?    Lets look for begining to &quot;traditional&quot; symbols table being used before XKB. </p>
  <p> Like in many another keyboard modules it can be represented as simple  two-dimensional table where each row corresponds to keycode and each column  corresponds to modifier or modifiers combination. </p>
  <p> First of all note that in the key press/release event only one byte (octet)  allocated for modifiers. So there can be eight modifiers only.  First three ones are named <strong>Shift, Lock, Control</strong> and all other are  &quot;unnamed&quot; - <strong>Mod1, Mod2, Mod3, Mod4, Mod5</strong>. <br/>
    I should note that though names of first three modifiers obviously  hints what keys they should correspond actually they can be binded  (it means modifiers will change own state at corresponded key press/release)  to any other keys </p>
  <p> But it's more important that the eight modifiers can form up to 256  different combinations. So in theory symbols table can include up to  256 columns. In the same time old standard strongly defines only  first four columns. You can guess that only two modifiers are used  to distinguish these columns, they are <strong>Shift</strong> and <strong>Mode_switch</strong>.  (You can see that there isn't modifier with name <strong>Mode_switch</strong>.  Yes, it's right. One of unnamed modifiers plays this role.  And <strong>Mode_switch</strong> is name of one of control symbols. When application  requests symbol table from server it also asks what modifier is bound to  this control symbol.) </p>
  <p> So first four columns corresponds to states: </p>
  <table border="2">
    <tbody>
      <tr>
        <th width="25%"> none modifiers</th>
        <th width="25%"> Shift </th>
        <th width="25%"> Mode_switch </th>
        <th width="25%"> Mode_switch+Shift </th>
      </tr>
    </tbody>
  </table>
  </p>
  <p> <br/>
    In core protocol terms we can say that the <strong>Mode_switch</strong> choose  one of two column groups (note that here &quot;group&quot; means not the same that  the &quot;XKB group&quot; about which we will talk below). And <strong>Shift</strong> state  choose one of two columns inside group. <br/>
    Of course you know that the different group usually used for  different alphabets and <strong>Shift</strong> choose small or capital letters  inside one alphabet. </p>
  <table border="2">
    <tbody>
      <tr>
        <th rowspan="2">  </th>
        <th colspan="2"> Group 1 </th>
        <th colspan="2"> Group 2 </th>
      </tr>
      <tr>
        <th width="20%">   </th>
        <th width="20%"> Shift </th>
        <th width="20%"> Mode_switch </th>
        <th width="20%"> Mode_switch+Shift </th>
      </tr>
      <tr>
        <td colspan="5"> ... </td>
      </tr>
      <tr>
        <td>keycode 38</td>
        <td align="center"> a</td>
        <td align="center"> A</td>
        <td align="center"> Cyrillic_ef </td>
        <td align="center"> Cyrillic_EF </td>
      </tr>
      <tr>
        <td>keycode  39</td>
        <td align="center"> s</td>
        <td align="center"> S</td>
        <td align="center"> Cyrillic_yeru </td>
        <td align="center"> Cyrillic_YERU </td>
      </tr>
      <tr>
        <td>keycode  40</td>
        <td align="center"> d</td>
        <td align="center"> D</td>
        <td align="center"> Cyrillic_ve </td>
        <td align="center"> Cyrillic_VE </td>
      </tr>
      <tr>
        <td colspan="5"> ... </td>
      </tr>
    </tbody>
  </table>
  </p>
  <p> Also note that neither <strong>Lock</strong> nor <strong>Control</strong> don't paricipate  in symbol choice. If these modifiers are active so special Xlib subroutines  makes additional convertion for symbol after its choice. </p>
  <p> Lets return to XKB module. You can see that the main disadvantage of  traditional symbols table is its unflexibility.    Though there can be up to 256 columns but only first four can be  standardly processed and their dependence on modifiers hardcoded  in Xlib. </p>
  <p> Therefore one of the basic improvements brought by XKB is large flexibility  in the table construction. </p>
  <ul>
    <li> First of all in XKB columns aren't strongly bound to concrete  modifiers. One of XKB configuration file describes column number dependence  on any modifiers set. Of course you can add or change such dependence by  editing of this file.  (More detaily about it see below: <a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/en/xkb/internals.html#types">Shift level calculation. Key types.</a>) </li>
    <li> The second one: in the same keyboard map different keys can contain  different number of symbols and their dependence on modifiers. For example
      <ul>
          <li><strong>Enter</strong> key doesn't depend on any modifiers state so in table  its row has only one column. </li>
        <li>key with symbols '1' and '!' has in table two columns and column  choice depends on only <strong>Shift</strong> state. </li>
        <li>but key with symbols '-','_' and '=' can have three columns and  their choice depends on two modifiers - <strong>Shift</strong> and <strong>Mod1</strong> </li>
      </ul>
    </li>
    <li> With such approach term &quot;group&quot; significantly change meaning.  We can't define group as &quot;pack of columns&quot; becouse such pack size will  be different for different keys. <br/>
      Generally with such flexibility of columns_to_modifiers binding  we can forget about groups or simply speak that the &quot;group&quot; is group of  columns united by one modifier state (<strong>Mode_switch</strong> for example) but ... </li>
  </ul>
  <p> It is very usefull to devide table into groups. First of all it makes  easier to separate different alphabets in one keyboard map. Note that  someone use two and more alphabets simultaneously. And strong bounds  between alphabets allow to complete such parts independly. <br/>
    And the second one is than more modifiers we involve to column  choice then more complicated and difficult to understand keyboard map become. </p>
  <p> So XKB design use radical approach - one keybord map can contain some  (up to four) tables. And these different table in XKB has name &quot;XKB groups&quot;  (or simply <strong>groups</strong>). </p>
  <p> It is more correctly to tell not &quot;some two-dimensional tables in one map&quot;  but &quot;each <strong>keycode</strong> can have up to four one-dimensional tables - groups&quot;. <br/>
    Becouse... </p>
  <ul>
    <li> Some keys meaning (<strong>Enter</strong> for example) is the same for  all alphabets. So they need not table division to separate groups. </li>
    <li> Even inside one group (alphabed) different keys can have different  number of columns. It means that the table width varies not only &quot;from group  to group&quot; but also &quot;from keycode to keycode&quot;. So it is more convenient  to describe each separate group for each separate keycode. </li>
    <li> And finally each keycode also has some other data  (see <a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/en/xkb/internals.html#key">below </a>) that doesn't depends on group number.  So if we would have some &quot;global&quot; tables and would describe such data  for the same key in different tables then this information could be  inconsistent. </li>
  </ul>
  <p> So... </p>
  <ul>
    <li> XKB keyboard map has keeps some one-dimensional tables of symbols  for each <strong>keycode</strong>. Such table name is <strong>group</strong>. </li>
    <li> Each <strong>group</strong> table can contain some columns - <strong>shift levels</strong>. </li>
    <li> What one-line table is current is pointed by &quot;current group number&quot;  (or simply <strong>group</strong>). X-server keeps current group number and reports  it with keycode and current modifiers set in <strong>key event</strong>. </li>
    <li> Column (<strong>shift level</strong>) inside group is chosen by current  modifiers set. </li>
    <li> Different <strong>keycode</strong> keycode can have different number of <strong>groups</strong>. </li>
    <li> Different group of the same <strong>keycode</strong> can have different        number of <strong>shift levels</strong>. </li>
  </ul>
  <table border="2">
    <tbody>
      <tr>
        <th> keycode </th>
        <th> groups number </th>
        <th> levels number </th>
        <th colspan="4">  </th>
      </tr>
      <tr>
        <td align="center"> 36</td>
        <td align="center"> 1 </td>
        <td align="center"> one column </td>
        <td align="center"><strong>Enter</strong></td>
        <td colspan="3">  </td>
      </tr>
      <tr>
        <td rowspan="3" align="center"> 38</td>
        <td align="center"> 1 </td>
        <td align="center"> two columns </td>
        <td align="center"> a</td>
        <td align="center"> A</td>
        <td colspan="2">  </td>
      </tr>
      <tr>
        <td align="center"> 2 </td>
        <td align="center"> three columns </td>
        <td align="center"> Cyrillic_ef </td>
        <td align="center"> Cyrillic_EF </td>
        <td colspan="2">  </td>
      </tr>
      <tr>
        <td align="center"> 3 </td>
        <td align="center"> two columns </td>
        <td align="center"> Greek_alpha </td>
        <td align="center"> Greek_ALPHA </td>
        <td colspan="2">  </td>
      </tr>
      <tr>
        <td rowspan="2" align="center"> 21 </td>
        <td align="center"> 1 </td>
        <td align="center"> two columns </td>
        <td align="center"> + </td>
        <td align="center"> = </td>
        <td colspan="2">  </td>
      </tr>
      <tr>
        <td align="center" width="12%"> 2 </td>
        <td align="center" width="12%"> four columns </td>
        <td align="center" width="12%"> + </td>
        <td align="center" width="12%"> = </td>
        <td align="center" width="12%"> \ </td>
        <td align="center" width="12%"> ; </td>
      </tr>
      <tr>
        <td colspan="7"> ... </td>
      </tr>
    </tbody>
  </table>
  <p> And finally I should say that the number of groups can be from 1 to 4 and  number of levels can be up to 64. </p>
  <h3><a name="actions" id="actions">Actions table.</a></h3>
  <p> Besides &quot;symbols table&quot; keycode can have bound &quot;<strong>actions</strong> table&quot;.  This table also can be devided to <strong>group</strong> sub-tables and <strong>levels</strong>. </p>
  <p> Unlike symbols table that is used by application (X-server only keeps it)  actions table is used by server itself. </p>
  <p> This table cells contains pointers to XKB internal procedures that changes  &quot;XKB state&quot; - current <a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/en/xkb/internals.html#state-group">group</a>, current <a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/en/xkb/internals.html#state-mods">modifiers set</a> and <a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/en/xkb/internals.html#controls">internal control flags set</a>. </p>
  <p> But it's more correctly to say that the <strong>actions</strong> functions isn't  limited by XKB state changing. They also are used for: </p>
  <ul>
    <li> <a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/en/xkb/internals.html#mouse">mouse events emulation</a> (pointer movement and mouse buttons press) </li>
    <li> special events generation </li>
    <li> screen switching </li>
    <li> X-server termination </li>
    <li> etc. </li>
  </ul>
  <p> More detaily about all possible <strong>actions</strong> you can read in <a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/en/xkb/gram-actions.html">Actions description</a>. </p>
  <p> It is important that if some cell (defined by <strong>group</strong> and <strong>shift level</strong>)in action table is filled with <strong>action</strong> so corresponded cell in symbols table must exist and be filled with  symbol (usually it's &quot;control symbol&quot;). </p>
  <p> Note that the old keyboard module has not actions mechanism. </p>
  <h3><a name="state-group" id="state-group">XKB state: current group number.</a></h3>
  <p> XKB keeps current group number in &quot;internal state&quot; table. <br/>
    Strictly speaking, there are three internal variables for group number </p>
  <ul>
    <li> <strong>locked group</strong> - analogue <strong>CapsLock</strong> key action for groups </li>
    <li> <strong>latched group</strong> - analogue <strong>Shift</strong> key action for groups </li>
    <li> <strong>base group</strong> - one another shift value for group number </li>
  </ul>
  These variables values can be changed by <strong>actions</strong> bound to  appropriate keys (<strong>keycodes</strong>).
  <p> And there is term <strong>effective group</strong> that is sum of all three  mentioned variables. This value XKB server part calculates at every  key press or release and reports to application in <strong>key event</strong> to  allow aplication choose needed symbol.  (Of course the same value server uses for <strong>action</strong> choice.) </p>
  <h3><a name="wrap" id="wrap">&quot;Keeping in range&quot; methods for group number.</a></h3>
  <p> Of course this sum can be bigger than number of groups are really used  in keyboard map. To make from it some reasonable value XKB can use one of  three methods: </p>
  <ul>
    <li> <strong>Wrap</strong> - XKB devides sum to number of defined groups and  takes rest. It's method by default. </li>
    <li> <strong>Clamp</strong> - if sum is bigger than highest group it will be  replaced with &quot;last group number&quot;, if sum less than one the first group  will be used. </li>
    <li> <strong>Redirect</strong> - if this method is used it need in XKB state  one another value defined - number &quot;where redirect to&quot; (or &quot;what replace with&quot;).  If sum is out of bounds this additional value will be used.  By the way if this value also is out of bounds XKB will use first group. </li>
  </ul>
  <h3><a name="mods" id="mods">Modifiers.</a></h3>
  <p> Besides group number variables &quot;XKB state&quot; contains variables for  bit flags that are named modifiers. These flags changes own state  when keys like <strong>Shift, CapsLock, Alt, Control</strong>, etc. are pressed  or released. </p>
  <p> As I said above old protocol also has modifiers set. Their names are <strong>Shift, Lock, Control, Mod1-Mod5</strong>. In dependence on their state Xlib  choose symbol from symbols table and can perform some additional actions  such as make control symbols from ordinar symbols, change small letters to  capital ones and so on. <br/>
    Also application can interpert modifiers in own way and so change own  behavior. </p>
  <p> XKB has more modifiers and thier behavior dependence on modifiers  can be flexibly changed (not at start only but at work time too).  But becouse of compatibility problem XKB needs to emulate traditional  modifiers set for old client program (linked with old Xlib). </p>
  <p> So traditional modifiers set in XKB have name <strong>real modifiers</strong> and names of each modifier are the same as in old standard. <br/>
    And XKB also has 16 own internal modifiers that was named <strong>virtual modifiers</strong>. </p>
  <p> Unfortunatly one part of compatibility problem is that the <strong>key event</strong> allocates only eight bits for modifiers. So there is not way to report  all sixteen XKB internal modifiers to the application in <strong>key event</strong> message. And XKB needs to map own <strong>virtual modifiers</strong> to <strong>real  modifiers</strong> even when it communicates with XKB-aware application.  The only consolation is you can map to one real modifiers as many virtual  modifiers as you want. </p>
  <p> Modifiers has some function: </p>
  <ul>
    <li> their state is used for <strong>shift level</strong> calculation for symbol  and/or <strong>action</strong> choice; </li>
    <li> their state is used for indicators state calculation; </li>
    <li> and since they are used for <strong>action</strong> choice so they influence  to all that the <strong>actions</strong> do - group number calculation, other modifiers  state changing and so on. </li>
  </ul>
  <h3><a name="state-mods" id="state-mods">XKB state: modifiers.</a></h3>
  <p> Like group number modifiers set inside XKB distributed to three variables </p>
  <ul>
    <li> <strong>locked modifiers</strong> </li>
    <li> <strong>latched modifiers</strong> </li>
    <li> <strong>base modifiers</strong> </li>
  </ul>
  These variables values can be changed by <strong>actions</strong>.
  <p> And as for group there is term <strong>effective modifiers</strong> that is  boolean sum (bitwise OR) of three mentioned variables. Of course since  it is boolean addition XKB needn't any additional acts to keep sum  in range. </p>
  <h3><a name="types" id="types">Shift level calculation. Key types.</a></h3>
  <p> XKB doesn't keep <strong>shift level</strong> like <strong>group</strong> number inside  but calculates it from modifiers state every time when need it.  And for each key level from modifiers dependence can be different. </p>
  <p> To allow such flexibility XKB uses &quot;key type&quot;. <br/>
    Key type is some function (in mathematic meaning) that describes  what modifiers need to be used for shift level calculation and what  level match to certain modifiers combination. <br/>
    And so each <strong>group</strong> sub-table for each <strong>keycode</strong> contains  key type identifier. </p>
  <p> When key is pressed XKB takes key type description from sub-table and  useing this description and modifiers state as argument calculates  cell number (what <strong>shift level</strong> means) symbol have to be chosen from. </p>
  <p> I should note that though key type for each keycode sub-table can be  changed flexibly XKB has &quot;basic set&quot; of key types and each keycode has  any type as default. Therefore usually one needn't specify key types in  keyboard map. </p>
  <h3><a name="key" id="key">What other data each keycode description has.</a></h3>
  <p> Besides symbols and actions tables each keycode description has some  other variables: </p>
  <ul>
    <li> method for keeping group in range specific for this key; </li>
    <li> key behavior; </li>
    <li> exceptions set; </li>
    <li> real (modmap) and virtual (vmodmap) modifiers </li>
  </ul>
  <h4><a name="key-wrap" id="key-wrap">Keep group number in range method.</a></h4>
  <p> Since different keys can have different number of groups it can occur  that the <strong>effective group</strong> value legal for whole keyboard map is too big  for some particilar keys. <br/>
    In such case effective group must be corrected especially for current key. </p>
  <p> Possible methods are the same as <a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/en/xkb/internals.html#wrap">&quot;global&quot; ones</a>.  By default <strong>Wrap</strong> method is used. </p>
  <h4><a name="key-behavior" id="key-behavior">Key behavior.</a></h4>
  <p> This variable consists of two parts - boolean flags and additional  argument. In most cases additional argument is not needed but some  flags assume additional numeric value. Of course argument meaning  depends on flag meaning. </p>
  <p> These flags defines: </p>
  <ul>
    <li> need this key &quot;autorepeat&quot; or not. (To say correctly this flag is  stored in another place but it make no sense for our consideration.) </li>
    <li> must this key be &quot;lockable&quot; (it means that after first press/release  this key stay logicaly pressed and will be unpressed after next press/release.)    Such locking can be performed by hardware or emulated by XKB module. </li>
    <li> is this key the member of any <a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/en/xkb/internals.html#radio">radio group</a>.  For this flag additional argument means radio group identifier. </li>
    <li> is this key the member of any <a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/en/xkb/internals.html#overlay">overlay group</a> There can be only two such group. What group is active in current time can  be managed by one of two <a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/en/xkb/internals.html#controls">XKB control flags</a> (names of flags are <strong>Overlay1</strong> and <strong>Overlay2</strong>). So there are  two flags in <strong>key behavior</strong> - &quot;is it the member of the first overlay group&quot;  and &quot;is it the member of the second overlay group&quot;. The additional argument  means keycode which will replace this key keycode if the corresponded overlay  group is active. </li>
  </ul>
  <h4><a name="key-explicit" id="key-explicit">Exceptions set.</a></h4>
  <p> It is bit mask that defines what keycode related data is  &quot;specified explicitly&quot; and must not be changed in some cases. The thing is  that the X-protocol include commands that allow application change  symbol_to_keycode binding in keyboard map inside X-server. Of course  these commands changes symbols placement only but doesn't change other data  such as <strong>action</strong>, key behavior or key bound modifiers. </p>
  <p> To allow XKB to move this data at symbol moving there is special mechanism -  symbol <a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/en/xkb/internals.html#compat">interpretation</a>. Useing this mechanism XKB  can move non-symbol data bound to keycode when application requests  the symbol moving. </p>
  <p> But in some cases such changes can be considered as unwanted.  So <strong>exceptions set</strong> can protect keycode related data against such  implicit changes. <br/>
    If application uses special XKB-protocol requests this protection  is unneeded. </p>
  <p> This mask can forbid </p>
  <ul>
    <li> to change key type (number of shift levels) for each group sub-table; </li>
    <li> changes that can occur at <strong>interpretation</strong> processing; you can  forbid:
      <ul>
          <li> all changes; </li>
        <li> <strong>autorepeat</strong> or <strong>lock</strong> flags changes; </li>
        <li> keycode bound modifiers changes; </li>
      </ul>
    </li>
  </ul>
  <h4><a name="key-mods" id="key-mods">Real and virtual modifiers.</a></h4>
  <p> First of all note that there are two variables for each keycode  (<strong>modmap</strong> and <strong>vmodmap</strong>) one variable for real modifier and  anoter one for virtual modifiers. </p>
  <p> The real modifier is used for traditional modifiers set emualtion  but virtual modifier can be used as argument for actions bound to  this key. </p>
  <p> I should say that the virtual modifiers set (<strong>base, locked</strong> and <strong>latched</strong> can be changed by appropriate <strong>action</strong>.  Of course this action must has argument that describes what modifiers  will be switched on/off. And if you describe such action you can  specify modifiers names explicitly or refer to <strong>vmodmap</strong> (that means &quot;set/unset modifiers bound to this key&quot;). </p>
  <p> But modifiers in the &quot;emulated traditional modifiers set&quot; changes  automaticaly at key press/release. You can guess that the &quot;emulated modifier&quot;  for particular key is modifier keeped in the real modifier variable  (<strong>modmap</strong>) of this key. </p>
  <p> Also these two variable are used for the virtual_to_real modifier mapping.  Remember that the virtual modifier has not any effect while it is not mapped  to any real modifier. </p>
  <h3><a name="controls" id="controls">XKB state: control flags (XKB Controls).</a></h3>
  <p> Besides group number and modifiers set there is another one set of bit  flags in XKB state. But in difference to group and modifiers that are  distributed to three variables (<strong>base, locked, latched</strong>)  this set occupate only one variable. </p>
  <p> Control flags set contain flags that are used for switching XKB modes  and isn't reported to application. <br/>
    These flags are used for </p>
  <ul>
    <li> switching <a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/en/xkb/internals.html#overlay">overlay mode</a> for keyboard parts; </li>
    <li> switching <a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/en/xkb/internals.html#mouse">mouse events emulation</a> modes. </li>
    <li> switching <a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/en/xkb/internals.html#accessx">AccessX</a> subsystem modes. </li>
    <li> and some other XKB properties. </li>
  </ul>
  <p> XKB controls (like group number and modifers) can be changed by  appropriate <a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/en/xkb/internals.html#actions">action</a> bound to some keys. </p>
  <h3><a name="indicators" id="indicators">Indicators.</a></h3>
  <p> You know that besides key keyboard has some indicator LEDs.  These indicators management is XKB duty too. <br/>
    XKB can have up to 32 indicators. <br/>
    Of course keyboard has only 3-4 LEDs and so can show state of  first 3-4 XKB indicators. These indicators have name &quot;physical indicators&quot;  and all other are &quot;virtual indicators&quot;.  Virtual indicators state can be read from XKB and be showed by special  programs (<strong>xkbvleds</strong>, <strong>mxkbledpanel</strong>). </p>
  <p> Each indicator can be bound to some component of &quot;XKB state&quot;  (modifier, group number or XKB control flag) and so indicator state  will reflect state of own XKB state component. </p>
  <p> And there are special XKB protocol requests that can be used by application  to change some indicator state (to switch on/off). Note that I talk about  possibility to switching on/off LED only but not about changeing keyboard  state component bound to this lamp. </p>
  <p> Therefore each indicator description has some flags that defines: </p>
  <ul>
    <li> could application change this indicator state (or to switch it on/off  you need to change keyboard state); </li>
    <li> is this indicator bound to some keyboard state component or it is  used by applications only; </li>
    <li> and finally, has this indicator &quot;feedback&quot;. It means you can  make indicator has influence to bound component and request to change  indicator state will cause change of component state (modifer state or group  number or control flag state). </li>
  </ul>
  <h3><a name="compat" id="compat">Compatibility table.</a></h3>
  <p> As I already mentioned above, XKB needs to solve the &quot;compatibility problem&quot;  working with application that aren't XKB-aware and that use traditional  protocol requests. </p>
  <p> Of course XKB can process such requests but the problem is that the XKB has  some new terms and mechanisms absent in traditional protocol (core protocol).  You guess that the core protocol requests doesn't deal with these mechanisms. </p>
  <ul>
    <li> First of all XKB has more modifiers (and can change their behavior  flexibly). Therefore XKB needs to support eight traditional modifiers  and to map own modifiers to these ones (as I told above). </li>
    <li> The second one is that the group number in the core protocol has another  meaning.  I already said that there are only two groups that can be switched by the <strong>Mode_Switch</strong> key and the current group in keyboard state can be reflected  by one of unnamed (<strong>Mod1-Mod5</strong>) modifiers that is bound to <strong>Mode_Switch</strong>.
      <p> Thus in core protocol the current group (base/alternative group) indication  needs only one bit and this bit is one of modifiers. But XKB for current  group number delivering heeds two-bit field and in keyboard event this field  placed separately from the modifiers set. </p>
      <p> Also in old keyboard protocol standard each group consists of two  levels exactly though each keycode can have up to 256 symbols.  First four cells in keycode row are &quot;two groups of two levels&quot;.  All other cells application can choose in dependence on Mod1-Mod5 modifiers  state in own way. </p>
      <p> Therefore for compatibility XKB needs ... </p>
      <ul>
          <li>First of all convert own &quot;group sub-table&quot; to one row of traditional  symbols table (to say honestly I still don't understand this action rules  except simplest case such as &quot;two group of two levels&quot;). </li>
        <li>And the second one, to convert own group number to any real modifier state. </li>
      </ul>
    </li>
    <li> The last problem is that the old keyboard module hasn't <strong>actions</strong> that are main feature provide XKB behavior flexibility. It leads to problem  when non XKB-aware program will request change of some symbol_to_keycode  binding. Since such program even doesn't suspect that this keycode can have  also some action bound, it's possible that the application will move  &quot;alphabet switcher&quot; to another key but <strong>action</strong> that really do such  switching will stay on old place.
      <p> To solve this problem XKB has table of &quot;control symbols interpretation&quot;  (or simply <strong>interpretation</strong> table). This table connects symbols codes  and corresponded <strong>actions</strong>. Of course only control symbols  (such as <strong>Caps_Lock, Shift, Num_Lock, &quot;alphabet switcher&quot;</strong>, etc.)  presents in this table. </p>
      <p> Besides symbols and actions itself each <strong>interpretation</strong> keeps some  additional data that is &quot;real modifier list&quot; and &quot;match criterion&quot;  (such as &quot;any of modifiers&quot;, &quot;all of modifiers&quot;, &quot;specified modifiers only&quot;,  etc.). </p>
      <p> Every time at symbos binding change XKB searchs this symbol in <strong>interpretation</strong> table (note that the XKB also do it at X-server start  time).  If symbol is found XKB with symbol binding also perform corresponded action  binding to the same position in keycode table.  The additional data (modifier and match criterion) also can be used for  seeking appropriate place for action. </p>
      <p> Also interpretation can change some other keycode properties such  as autorepeat and locking flags and virtual modifier (bound to keycode). </p>
      <p> I should remind that the keycode can have &quot;exceptions set&quot; that protects  keycode properties against such changes. </p>
      <p> I should mention that though <strong>actions</strong> can be specified in  keyboard map tables but to place all <strong>actions</strong> in <strong>interpretation</strong> table is &quot;right thing&quot;. Since in this table each action is bound to  control symbol (not to some position in keycode tables) and XKB moves  action from interpretation table to keyboard map at configuration load time  so it allow XKB to find most appropriate place for each action.  Thus all symbols and actions will be bound to keycode in most correct way. </p>
    </li>
  </ul>
  <h2>Few other terms.</h2>
  <h3><a name="radio" id="radio">Radio Groups.</a></h3>
  <p> XKB module allow to unite some keys to one radio-group. It means  that all keys states in such group depends on each other.  At one key press all other keys become unpressed. </p>
  <p> Of course pressed key will stay in pressed state until some other  key of group will be pressed. The belonging of concrete key to radio-group  can be defined in &quot;key behavior&quot;. </p>
  <p> In the same place you can specify one additional property for radio-group  that defines possibility to release all keys simultaneously.  Usual radio-group definition assumes that the one of keys always must be in  pressed state. To release it you need to press any another key but in  such case this second key become pressed. If radio-group has property  &quot;allow to release all keys&quot; you can simply press logicaly pressed key  one more time and this key (and all other from group) will become logicaly  unpressed. </p>
  <p> XKB allow to have up to 127 radio groups. </p>
  <h3><a name="overlay" id="overlay">Overlay group.</a></h3>
  <p> XKB allow some keys to have alternative scan-code (keycode).  It means that in normal state when such key is pressed and keyboard  generates its scan-code XKB use this scan-code in usual way.  But when overlay mode is switched on XKB replaces this scan-code by  alternative one ant then deal with this new code. </p>
  <p> Such group of keys that has alternative keycodes is named &quot;overlay group&quot;  (or simply <strong>overlay</strong>). There can be only two such group.   The belonging of concrete key to overlay group and alternative keycode itself  can be defined in &quot;key behavior&quot;. </p>
  <h3> <a name="accessx" id="accessx">AccessX. Additional services for physically               impaired persons.</a></h3>
  <p> There are people who has limited mobility of hands (fingers) or need  to use some devices to access keyboard. </p>
  <p> The problems can occur are: </p>
  <ul>
    <li> It's impossible to press two (or more) keys at the same time  (for example <strong>Shift</strong>+&quot;letter&quot;).   To solve this problem XKB has <strong>StickyKeys</strong> mode. This mode change  behavior of modifier keys and allow to press they in sequence instead of  simultaneously. For example instead of <strong>Shift+Control+C</strong> one can  press and release <strong>Shift</strong> key then press and release <strong>Control</strong> key  and then press <strong>C</strong> key. Note that only modifier keys become &quot;sticky&quot;.  It means that after modifier key press the XKB waits another key press but  when ordinary (letter) key press the XKB gnerates keyboard event. <br/>
      On the other hand this mode itself can cause problem if modifier  key was pressed by a mistake. Therefore <strong>StickyKeys</strong> mode has special  delay time when the XKB waits another key. After this time expire key become  logicaly unpressed. </li>
    <li> Some user can accedentally &quot;bounce&quot; key when he press or release it.  To avoid such &quot;bounce effect&quot; the XKB has <strong>BounceKeys</strong> mode.  This mode means that after first physical key press this key become  &quot;insensible&quot; and so will ignore other press/release at some time. </li>
    <li> Some user can accidenally bump unneeded key while moving hand  from key to key. To solve this problem the XKB has <strong>SlowKeys</strong> mode.  In this mode each key is considered as pressed if it is physically pressed  while some time. In the other words if you will press key and then release  it quickly the XKB will ignore such short term press. </li>
    <li> It can be hard or impssible to move mouse device. To solve this problem  the XKB can emulate mouse events by keyboard.  More detaily about this mode see <a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/en/xkb/internals.html#mouse">below</a>. </li>
  </ul>
  <p> All these modes are performed by part of XKB module that has name AccessX.  Each mode can be switched on/off by change of XKB control flags with the same  names. </p>
  <p> Also note the AccessX modes switching on itself can be a problem.  (Lets imagine that user needs <strong>StickyKeys</strong> mode but to switch it on  he need to press complex key combination). Therefore to switch on some modes  the special actions are used: </p>
  <ul>
    <li> If <strong>Shift</strong> key is physicaly pressed and stay in such state  more then 8 seconds the <strong>SlowKeys</strong> mode become active. </li>
    <li> If <strong>Shift</strong> key is pressed sequentally five times the <strong>StickyKeys</strong> mode become active. </li>
  </ul>
  <p> But to make the XKB recognize such &quot;magic sequences&quot; a special mode  (<strong>AccessXKeys</strong>) must be switched on in its own turn.  To activate it you can ... </p>
  <ul>
    <li> to specify special command line option at X-server start or </li>
    <li> to set needed control flag in XKB configuration file or </li>
    <li> to set the same flag by pressing key with appropiate <strong>action</strong>.  (by default such key absent but you can add it in keyboard map if you need). </li>
  </ul>
  <p> On the other hand if one of AccessX modes is active but computer is used  by different users this mode can disturb some people. Therefore the XKB  has special option that allow automatically switch off AccessX modes if  keyboard stay not in use long time.  And <strong>StickyKeys</strong> mode (simultaneous key pressing emulation by  sequental press) become inactive if you will press some keys really  simultaneously. <br/>
    This automatical deactivation (as the other modes) can be switched on/off  by corresponded XKB control flag (<strong>AccessXTimeout</strong>). <a name="accessxfeedback" id="accessxfeedback"></a> </p>
  <p> And finally, AccessX has special mode of additional sound indication  of all events such as several timeouts begin and end and LEDs switching.  To allow users distinguish these events (especially when more then one  AccessX mode is active) the XKB tries to make different sounds (in pitch  and duration) for different events as far as hardware allow. <br/>
    This mode as the other modes can be switched on/off by corresponded  XKB control flag (<strong>AccessXFeedback</strong>). Also sound for separate events  can be switched on/off seprately. </p>
  <h3><a name="mouse" id="mouse">Mouse emulation.</a></h3>
  <p> The XKB can emulate mouse events by keyboard. It means that it can  be configured to produce events about mouse movement and mouse button  pressing instead of key press events. </p>
  <p> It can be done by corresponded <a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/en/xkb/internals.html#actions">actions</a> such  as &quot;pointer movement&quot;, &quot;mouse button press&quot;, &quot;mouse mouse button choice&quot;. </p>
  <p> Some details: </p>
  <ul>
    <li> In pointer movement <strong>action</strong> you can specify both coordinates  or their changes. Coordinates can be absolute (it means that you spesify  point on screen exactly) or realtive that means movement to some points  to needed direction. Usualy there are some <strong>action</strong> with the same  direction but with different distance values - one point, ten points, etc.  These <strong>action</strong> can be bound to the same key but to different  shift levels. It means that press such key alone you will get one-point  movement but being pressed with Shift key the same key will cause more  long movement per one key press. </li>
    <li> In mouse button press <strong>action</strong> you can specify &quot;repeat counter&quot;  besides button number. It means that by key one press you can produce  double-click (or triple or more). </li>
    <li> Also there is variant of such action that not only press mouse button  but leaves it logicaly pressed after key release (as all <strong>Lock</strong> keys do)  It means that with such action you can &quot;press mouse button&quot; then move pointer  and then &quot;release mouse button&quot; by second press of the same key. </li>
    <li> And finally, note that mouse can have up to 5 buttons and with  multi-click and lockable variants it could happen that you will need many  different keys for muse buttons. To reduce their number XKB has a <strong>default button</strong> term. To deal with this button there is special <strong>action</strong> that allow specify concrete button as default button or relative  change of current default button number. Using last one you can change current  default button in cycle by one key. And in all &quot;mouse button <strong>actions</strong>&quot;  you can specify that this action is related to button that is default button  in current time. (There is only one problem - to remember what button is  default now :-). </li>
  </ul>
  <p> Also there are two modes of mouse pointer movement - the simple movement  and the movement with acceleration. At single press there is not difference  between these two modes. But if you will keep key pressed and it begin to  autorepeat so in normal mode pointer will be moved on the same number of pixels  (on value specified in <strong>action</strong> arguments).   But in <strong>accelerated mode</strong> size of one step will grow from step to step. </p>
  <p> This acceleration process has some additional parameters that are saved  in XKB internal variables (are the part of XKB state).  (I should note that accelearted mode has own autorepeat parameters -  delay between physical key press and autorepeat begin and time interval  between autorepeat events).    So these numeric parameters are: </p>
  <ul>
    <li><strong>delay</strong> - delay (in milliseconds) between key first press and  autorepeat first event. </li>
    <li><strong>interval</strong> - interval (in milliseconds) between autorepeat events. </li>
    <li><strong>maxspeed</strong> - maximum speed (in pixels per event). </li>
    <li><strong>timetomax</strong> - number of events after which speed become <strong>maxspeed</strong>. You can see that there is not explicit acceleration value.  XKB calculates it from initial step size (specified in action agruments), <strong>maxspeed</strong> and <strong>timetomax</strong>. </li>
    <li><strong>curve</strong> - acceleration &quot;curve factor&quot;. The thing is that speed can  grow not lineary only. In general speed grows proportialy to <strong>X^(1 + curve/1000)</strong> function. Thus with curve=0 growth is linear but  with another values (from -1000 to 1000) growth has some curvature. </li>
  </ul>
  By deafult accelerated mode is active.
  <p> Mouse emulation switching on/off and movement mode choice can be performed  by two <a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/en/xkb/internals.html#controls">XKB control flags</a> - <strong>MouseKeys</strong> and <strong>MouseKeysAccel</strong>. </p>
  <p> I should note that by default all needed actions are described in the XKB  configuration and are bound to <strong>NUMPAD</strong> keys. To switch on/off  the mouse emulation mode you can use <strong>Shift+NumLock</strong> keys combination. </p>
  <h3><a name="bell" id="bell">Bell features extension.</a></h3>
  <p> It can seems that this part has not relation to keyboard. <br/>
    Moreover, for users of computers where keyboard, display and &quot;speaker&quot;  are independent devices such combination can looks very strange.  But since in some hardware bell is placed in keyboard and produce <strong>key_click</strong> sound at every key press so X's design consider that bell  control is keyboard mode duty. </p>
  <p> I should note that bell control presents in old (core protocol)  keyboard module. With special requests to X-server application can change <strong>key_click</strong> parameters (tone, duration and loudness) and produce  this sound when it needs. </p>
  <p> The XKB module offers advanced bell features and allows not only cause <strong>click</strong> sound but play music fragment.  Of course to provide such &quot;music accompaniment&quot; is too complex task for  keyboard module. First aff all it needs some 'sound database' and the second  it has to support many different hardware (sound cards). </p>
  <p> Therefore XKB design assumes that there must exists special application  (&quot;juke-box&quot;) for sound play. And the XKB simply generates special event  (instead og click sound) that can be delivered to any application as all  other events. Juke-box has to say to X-server at start that it acceps  some kind of events (in this case xkb <strong>bell-events</strong>). </p>
  <p> Of course, if such music box presents its ability is not limited with  bell sound with different tone/duration play. It would can play many  music fragments from own database. <br/>
    Therefore XKB <strong>bell events</strong> contains not sound parameters but  simply some &quot;sound name&quot; (or &quot;bell name&quot;). And music box has to have  some table where each bell name is bound to concrete music fragment. </p>
  <p> So application working with XKB can request not simple bell but any  sound specifying its name. Note that XKB doesn't perform any check of  such sound names but simply retranslate them to juke-box. </p>
  <p> Of course XKB not only retranslates &quot;sound requests&quot; from applications  to juke-box but can request sound for own needs (when it changes own state). </p></td>
<td width="200" class="links" valign="top" align="left" style="padding-top:150px;">
 
</td>
</tr>
</table>
<div id="copyright">&copy; <a href="https://web.archive.org/web/20190718184358/mailto:pascal@tsu.ru">Иван Паскаль</a></div>
</body>
</html>
<!--
     FILE ARCHIVED ON 18:43:58 Jul 18, 2019 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 22:59:15 Aug 11, 2022.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
-->
<!--
playback timings (ms):
  captures_list: 138.805
  exclusion.robots: 0.188
  exclusion.robots.policy: 0.181
  cdx.remote: 0.059
  esindex: 0.01
  LoadShardBlock: 91.052 (3)
  PetaboxLoader3.datanode: 135.869 (4)
  CDXLines.iter: 13.692 (3)
  load_resource: 194.669
  PetaboxLoader3.resolve: 87.63
-->