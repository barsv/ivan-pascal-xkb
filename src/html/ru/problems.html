<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head><script src="//archive.org/includes/analytics.js?v=cf34f82" type="text/javascript"></script>
<script type="text/javascript">window.addEventListener('DOMContentLoaded',function(){var v=archive_analytics.values;v.service='wb';v.server_name='wwwb-app213.us.archive.org';v.server_ms=443;archive_analytics.send_pageview({});});</script>
<script type="text/javascript" src="/_static/js/bundle-playback.js?v=KTqwAcYd" charset="utf-8"></script>
<script type="text/javascript" src="/_static/js/wombat.js?v=UHAOicsW" charset="utf-8"></script>
<script type="text/javascript">
  __wm.init("https://web.archive.org/web");
  __wm.wombat("http://pascal.tsu.ru:80/other/xkb/problems.html","20190720144918","https://web.archive.org/","web","/_static/",
	      "1563634158");
</script>
<link rel="stylesheet" type="text/css" href="/_static/css/banner-styles.css?v=fantwOh2" />
<link rel="stylesheet" type="text/css" href="/_static/css/iconochive.css?v=qtvMKcIJ" />
<!-- End Wayback Rewrite JS Include -->

<meta http-equiv="Content-Type" content="text/html; charset=windows-1251"/>
<title>Ivan Pascal (Homepage)</title>
<style type="text/css" media="all">@import url(/web/20190720144918cs_/http://pascal.tsu.ru/css/style.css);</style>
</head>
<body><!-- BEGIN WAYBACK TOOLBAR INSERT -->
<style type="text/css">
body {
  margin-top:0 !important;
  padding-top:0 !important;
  /*min-width:800px !important;*/
}
</style>
<script>__wm.rw(0);</script>
<div id="wm-ipp-base" lang="en" style="display:none;direction:ltr;">
<div id="wm-ipp" style="position:fixed;left:0;top:0;right:0;">
<div id="donato" style="position:relative;width:100%;">
  <div id="donato-base">
    <iframe id="donato-if" src="https://archive.org/includes/donate.php?as_page=1&amp;platform=wb&amp;referer=https%3A//web.archive.org/web/20190720144918/http%3A//pascal.tsu.ru/other/xkb/problems.html"
	    scrolling="no" frameborder="0" style="width:100%; height:100%">
    </iframe>
  </div>
</div><div id="wm-ipp-inside">
  <div id="wm-toolbar" style="position:relative;display:flex;flex-flow:row nowrap;justify-content:space-between;">
    <div id="wm-logo" style="/*width:110px;*/padding-top:12px;">
      <a href="/web/" title="Wayback Machine home page"><img src="/_static/images/toolbar/wayback-toolbar-logo-200.png" srcset="/_static/images/toolbar/wayback-toolbar-logo-100.png, /_static/images/toolbar/wayback-toolbar-logo-150.png 1.5x, /_static/images/toolbar/wayback-toolbar-logo-200.png 2x" alt="Wayback Machine" style="width:100px" border="0" /></a>
    </div>
    <div class="c" style="display:flex;flex-flow:column nowrap;justify-content:space-between;flex:1;">
      <form class="u" style="display:flex;flex-direction:row;flex-wrap:nowrap;" target="_top" method="get" action="/web/submit" name="wmtb" id="wmtb"><input type="text" name="url" id="wmtbURL" value="http://pascal.tsu.ru/other/xkb/problems.html" onfocus="this.focus();this.select();" style="flex:1;"/><input type="hidden" name="type" value="replay" /><input type="hidden" name="date" value="20190720144918" /><input type="submit" value="Go" />
      </form>
      <div style="display:flex;flex-flow:row nowrap;align-items:flex-end;">
		<div class="s" id="wm-nav-captures" style="flex:1;">
	  	  <a class="t" href="/web/20190720144918*/http://pascal.tsu.ru/other/xkb/problems.html" title="See a list of every capture for this URL">30 captures</a>
	  <div class="r" title="Timespan for captures of this URL">31 Dec 2003 - 24 Aug 2019</div>
	  </div>
	<div class="k">
	  <a href="" id="wm-graph-anchor">
	    <div id="wm-ipp-sparkline" title="Explore captures for this URL" style="position: relative">
	      <canvas id="wm-sparkline-canvas" width="675" height="27" border="0"></canvas>
	    </div>
	  </a>
	</div>
      </div>
    </div>
    <div class="n">
      <table>
	<tbody>
	  <!-- NEXT/PREV MONTH NAV AND MONTH INDICATOR -->
	  <tr class="m">
	    <td class="b" nowrap="nowrap"><a href="https://web.archive.org/web/20190618113917/http://pascal.tsu.ru:80/other/xkb/problems.html" title="18 Jun 2019"><strong>Jun</strong></a></td>
	    <td class="c" id="displayMonthEl" title="You are here: 14:49:18 Jul 20, 2019">JUL</td>
	    <td class="f" nowrap="nowrap"><a href="https://web.archive.org/web/20190824111944/http://pascal.tsu.ru:80/other/xkb/problems.html" title="24 Aug 2019"><strong>Aug</strong></a></td>
	  </tr>
	  <!-- NEXT/PREV CAPTURE NAV AND DAY OF MONTH INDICATOR -->
	  <tr class="d">
	    <td class="b" nowrap="nowrap"><a href="https://web.archive.org/web/20190618113917/http://pascal.tsu.ru:80/other/xkb/problems.html" title="11:39:17 Jun 18, 2019"><img src="/_static/images/toolbar/wm_tb_prv_on.png" alt="Previous capture" width="14" height="16" border="0" /></a></td>
	    <td class="c" id="displayDayEl" style="width:34px;font-size:22px;white-space:nowrap;" title="You are here: 14:49:18 Jul 20, 2019">20</td>
	    <td class="f" nowrap="nowrap"><a href="https://web.archive.org/web/20190824111944/http://pascal.tsu.ru:80/other/xkb/problems.html" title="11:19:44 Aug 24, 2019"><img src="/_static/images/toolbar/wm_tb_nxt_on.png" alt="Next capture" width="14" height="16" border="0" /></a></td>
	  </tr>
	  <!-- NEXT/PREV YEAR NAV AND YEAR INDICATOR -->
	  <tr class="y">
	    <td class="b" nowrap="nowrap"><a href="https://web.archive.org/web/20171008042526/http://pascal.tsu.ru:80/other/xkb/problems.html" title="08 Oct 2017"><strong>2017</strong></a></td>
	    <td class="c" id="displayYearEl" title="You are here: 14:49:18 Jul 20, 2019">2019</td>
	    <td class="f" nowrap="nowrap">2020</td>
	  </tr>
	</tbody>
      </table>
    </div>
    <div class="r" style="display:flex;flex-flow:column nowrap;align-items:flex-end;justify-content:space-between;">
      <div id="wm-btns" style="text-align:right;height:23px;">
        	<span class="xxs">
          <div id="wm-save-snapshot-success">success</div>
          <div id="wm-save-snapshot-fail">fail</div>
          <a id="wm-save-snapshot-open" href="#"
	     title="Share via My Web Archive" >
            <span class="iconochive-web"></span>
          </a>
          <a href="https://archive.org/account/login.php" title="Sign In" id="wm-sign-in">
            <span class="iconochive-person"></span>
          </a>
          <span id="wm-save-snapshot-in-progress" class="iconochive-web"></span>
	</span>
        	<a class="xxs" href="http://faq.web.archive.org/" title="Get some help using the Wayback Machine" style="top:-6px;"><span class="iconochive-question" style="color:rgb(87,186,244);font-size:160%;"></span></a>
	<a id="wm-tb-close" href="#close" style="top:-2px;" title="Close the toolbar"><span class="iconochive-remove-circle" style="color:#888888;font-size:240%;"></span></a>
      </div>
      <div id="wm-share" class="xxs">
        <a href="/web/20190720144918/http://web.archive.org/screenshot/http://pascal.tsu.ru/other/xkb/problems.html"
           id="wm-screenshot"
           title="screenshot">
          <span class="wm-icon-screen-shot"></span>
        </a>
        <a href="#" id="wm-video" title="video">
          <span class="iconochive-movies"></span>
        </a>
	<a id="wm-share-facebook" href="#" data-url="https://web.archive.org/web/20190720144918/http://pascal.tsu.ru:80/other/xkb/problems.html" title="Share on Facebook" style="margin-right:5px;" target="_blank"><span class="iconochive-facebook" style="color:#3b5998;font-size:160%;"></span></a>
	<a id="wm-share-twitter" href="#" data-url="https://web.archive.org/web/20190720144918/http://pascal.tsu.ru:80/other/xkb/problems.html" title="Share on Twitter" style="margin-right:5px;" target="_blank"><span class="iconochive-twitter" style="color:#1dcaff;font-size:160%;"></span></a>
      </div>
      <div style="padding-right:2px;text-align:right;white-space:nowrap;">
	<a id="wm-expand" class="wm-btn wm-closed" href="#expand" onclick="__wm.ex(event);return false;"><span id="wm-expand-icon" class="iconochive-down-solid"></span> <span class="xxs" style="font-size:80%;">About this capture</span></a>
      </div>
    </div>
  </div>
    <div id="wm-capinfo" style="border-top:1px solid #777;display:none; overflow: hidden">
                    <div id="wm-capinfo-collected-by">
    <div style="background-color:#666;color:#fff;font-weight:bold;text-align:center">COLLECTED BY</div>
    <div style="padding:3px;position:relative" id="wm-collected-by-content">
            <div style="display:inline-block;vertical-align:top;width:50%;">
			<span class="c-logo" style="background-image:url(https://archive.org/services/img/alexacrawls);"></span>
		Organization: <a style="color:#33f;" href="https://archive.org/details/alexacrawls" target="_new"><span class="wm-title">Alexa Crawls</span></a>
		<div style="max-height:75px;overflow:hidden;position:relative;">
	  <div style="position:absolute;top:0;left:0;width:100%;height:75px;background:linear-gradient(to bottom,rgba(255,255,255,0) 0%,rgba(255,255,255,0) 90%,rgba(255,255,255,255) 100%);"></div>
	  Starting in 1996, <a href="http://www.alexa.com/">Alexa Internet</a> has been donating their crawl data to the Internet Archive.  Flowing in every day, these data are added to the <a href="http://web.archive.org/">Wayback Machine</a> after an embargo period.
	</div>
	      </div>
      <div style="display:inline-block;vertical-align:top;width:49%;">
			<span class="c-logo" style="background-image:url(https://archive.org/services/img/alexacrawls)"></span>
		<div>Collection: <a style="color:#33f;" href="https://archive.org/details/alexacrawls" target="_new"><span class="wm-title">Alexa Crawls</span></a></div>
		<div style="max-height:75px;overflow:hidden;position:relative;">
	  <div style="position:absolute;top:0;left:0;width:100%;height:75px;background:linear-gradient(to bottom,rgba(255,255,255,0) 0%,rgba(255,255,255,0) 90%,rgba(255,255,255,255) 100%);"></div>
	  Starting in 1996, <a href="http://www.alexa.com/">Alexa Internet</a> has been donating their crawl data to the Internet Archive.  Flowing in every day, these data are added to the <a href="http://web.archive.org/">Wayback Machine</a> after an embargo period.
	</div>
	      </div>
    </div>
    </div>
    <div id="wm-capinfo-timestamps">
    <div style="background-color:#666;color:#fff;font-weight:bold;text-align:center" title="Timestamps for the elements of this page">TIMESTAMPS</div>
    <div>
      <div id="wm-capresources" style="margin:0 5px 5px 5px;max-height:250px;overflow-y:scroll !important"></div>
      <div id="wm-capresources-loading" style="text-align:left;margin:0 20px 5px 5px;display:none"><img src="/_static/images/loading.gif" alt="loading" /></div>
    </div>
    </div>
  </div></div></div></div><div id="wm-ipp-print">The Wayback Machine - https://web.archive.org/web/20190720144918/http://pascal.tsu.ru:80/other/xkb/problems.html</div>
<script type="text/javascript">//<![CDATA[
__wm.bt(675,27,25,2,"web","http://pascal.tsu.ru/other/xkb/problems.html","20190720144918",1996,"/_static/",["/_static/css/banner-styles.css?v=fantwOh2","/_static/css/iconochive.css?v=qtvMKcIJ"], false);
  __wm.rw(1);
//]]></script>
<!-- END WAYBACK TOOLBAR INSERT -->

<div style="position:absolute; top:10; right:0; z-index:3"><img src="/web/20190720144918im_/http://pascal.tsu.ru/img/logo.jpg"/>
<div style=" font-size:11px;">
<a href="https://web.archive.org/web/20190720144918/http://pascal.tsu.ru/en/">ENGLISH</a> | 
<a href="https://web.archive.org/web/20190720144918/http://pascal.tsu.ru/">KOI</a> | 
<a href="https://web.archive.org/web/20190720144918/http://pascal.tsu.ru/win/">WIN</a> | 
<a href="https://web.archive.org/web/20190720144918/http://pascal.tsu.ru/alt/">ALT</a> | 
<a href="https://web.archive.org/web/20190720144918/http://pascal.tsu.ru/iso/">ISO</a></div>
</div>

<div id="head"><h2>Иван Паскаль</h2>
<div class="anotation">
Этот сайт посвящен описанию Операционной Системы
<noindex><a href="https://web.archive.org/web/20190720144918/http://www.freebsd.org/">FreeBSD</a></noindex> (одна из разновидностей Unix). 
<br/>
Я его сделал для того, чтобы хоть немного восполнить недостаток
документации, особенно на русском языке.<a href="unix"> Полная "Table of Contents"</a>
</p>
</div>
</div>


<table width="100%">
<tr>
<td width="300" valign="top">

<div id="block">
<div class="title"><a href="https://web.archive.org/web/20190720144918/http://pascal.tsu.ru/unix/add/adding.html">Добавление компонент из дистрибутива</a></div>
	<ul>
		<li><a href="https://web.archive.org/web/20190720144918/http://pascal.tsu.ru/unix/add/packages.html">Установка "пакетов" (packages)</a></li>
		<li><a href="https://web.archive.org/web/20190720144918/http://pascal.tsu.ru/unix/add/ports.html">Установка "портов" (ports)</a></li>
		<li><a href="https://web.archive.org/web/20190720144918/http://pascal.tsu.ru/unix/add/sysinst.html">С помощью программы sysinstall</a></li>
		<li><a href="https://web.archive.org/web/20190720144918/http://pascal.tsu.ru/unix/add/manualy.html">Установка "вручную"</a></li>
	</ul>
</div>
<div id="block">
<div class="title"><a href="https://web.archive.org/web/20190720144918/http://pascal.tsu.ru/unix/users/users0.html">Работа администратора с user account</a></div>
<ul>
  <li> <a href="https://web.archive.org/web/20190720144918/http://pascal.tsu.ru/unix/users/users1.html">Что такое &quot;учетная карточка&quot;?</a> </li>
  <li> <a href="https://web.archive.org/web/20190720144918/http://pascal.tsu.ru/unix/users/users2.html">Что  хранится в учетной карточке?</a> </li>
  <li> <a href="https://web.archive.org/web/20190720144918/http://pascal.tsu.ru/unix/users/users3.html">Для чего используется учетная карточка?</a> </li>
  <li> <a href="https://web.archive.org/web/20190720144918/http://pascal.tsu.ru/unix/users/users4.html">Где хранятся учетные карточки?</a> </li>
  <li> <a href="https://web.archive.org/web/20190720144918/http://pascal.tsu.ru/unix/users/users5.html">Добавление пользователя</a></li>
  <li> <a href="https://web.archive.org/web/20190720144918/http://pascal.tsu.ru/unix/users/users6.html">Редактирование данных учетной карточки?</a> </li>
  <li> <a href="https://web.archive.org/web/20190720144918/http://pascal.tsu.ru/unix/users/users7.html">Удаление пользователя</a></li>
  <li> <a href="https://web.archive.org/web/20190720144918/http://pascal.tsu.ru/unix/users/users8.html">Права пользователя на учетную карточку</a></li>
  <li> <a href="https://web.archive.org/web/20190720144918/http://pascal.tsu.ru/unix/users/users9.html">Временная блокировка пользователя</a></li>
  <li> <a href="https://web.archive.org/web/20190720144918/http://pascal.tsu.ru/unix/users/users10.html">Что еще почитать?</a> </li>
</ul>
</div>
<div id="block">
<div class="title"><a href="https://web.archive.org/web/20190720144918/http://pascal.tsu.ru/unix/users/groups.html">Группы (пользователей)</a></div>
<ul>
  <li> <a href="https://web.archive.org/web/20190720144918/http://pascal.tsu.ru/unix/users/groups1.html">Что такое группа?</a> </li>
  <li> <a href="https://web.archive.org/web/20190720144918/http://pascal.tsu.ru/unix/users/groups2.html">Где хранится информация о группах?</a> </li>
  <li> <a href="https://web.archive.org/web/20190720144918/http://pascal.tsu.ru/unix/users/groups3.html">Колличество групп, юзеров в группе, групп у юзера</a></li>
  <li> <a href="https://web.archive.org/web/20190720144918/http://pascal.tsu.ru/unix/users/groups4.html">Как создать или удалить группу?</a> </li>
  <li> <a href="https://web.archive.org/web/20190720144918/http://pascal.tsu.ru/unix/users/groups5.html">Редактирование принадлежности юзера к группе</a> </li>
</ul>
</div>
<div id="block">
<div class="title"><a href="https://web.archive.org/web/20190720144918/http://pascal.tsu.ru/unix/files/files1.html">Права доступа к файлам</a></div>
<ul>
	<li><a href="https://web.archive.org/web/20190720144918/http://pascal.tsu.ru/unix/files/files2.html">Какие атрибуты файла определяют &quot;право доступа&quot;.</a></li>
	<li><a href="https://web.archive.org/web/20190720144918/http://pascal.tsu.ru/unix/files/files3.html">Основные биты доступа (чтение/запись/выполнение)</a> </li>
	<li><a href="https://web.archive.org/web/20190720144918/http://pascal.tsu.ru/unix/files/files4.html">Дополнительные биты доступа</a> </li>
	<li><a href="https://web.archive.org/web/20190720144918/http://pascal.tsu.ru/unix/files/files5.html">&quot;Странные&quot; сочетания битов доступа.</a> </li>
	<li><a href="https://web.archive.org/web/20190720144918/http://pascal.tsu.ru/unix/files/files6.html">Флаги.</a> </li>
	<li><a href="https://web.archive.org/web/20190720144918/http://pascal.tsu.ru/unix/files/files7.html">С какими правами файл &quot;рождается&quot;</a> </li>
	<li><a href="https://web.archive.org/web/20190720144918/http://pascal.tsu.ru/unix/files/files7a.html">Права после копирования или перемещения</a></li>
	<li><a href="https://web.archive.org/web/20190720144918/http://pascal.tsu.ru/unix/files/files8.html">Как поменять права </a></li>
	<li><a href="https://web.archive.org/web/20190720144918/http://pascal.tsu.ru/unix/files/files9.html">Что делать если этого не хватает?</a> </li>
</ul>
</div>
<div id="block">
<div class="title"><a href="https://web.archive.org/web/20190720144918/http://pascal.tsu.ru/unix/syscons/syscons.html">Драйвер "системной консоли" - syscons</a></div>
<ul>
  <li><a href="https://web.archive.org/web/20190720144918/http://pascal.tsu.ru/unix/syscons/main.html">Основные возможности syscons</a> </li>
  <li><a href="https://web.archive.org/web/20190720144918/http://pascal.tsu.ru/unix/syscons/screen.html">Дисплей</a> </li>
  <li><a href="https://web.archive.org/web/20190720144918/http://pascal.tsu.ru/unix/syscons/keyboard.html">Клавиатура</a> </li>
  <li><a href="https://web.archive.org/web/20190720144918/http://pascal.tsu.ru/unix/syscons/kbd-examples.html">Примеры изменения назначения клавиш.</a> </li>
  <li><a href="https://web.archive.org/web/20190720144918/http://pascal.tsu.ru/unix/syscons/vidcontrol.html">Программа vidcontrol</a> </li>
  <li><a href="https://web.archive.org/web/20190720144918/http://pascal.tsu.ru/unix/syscons/kbdcontrol.html">Программа kbdcontrol</a> </li>
  <li><a href="https://web.archive.org/web/20190720144918/http://pascal.tsu.ru/unix/syscons/russian.html">Русификация syscons</a> </li>
  <li><a href="https://web.archive.org/web/20190720144918/http://pascal.tsu.ru/unix/syscons/termcap.html">&quot;Взаимопонимание&quot; программ с терминалом </a></li>
  <li><a href="https://web.archive.org/web/20190720144918/http://pascal.tsu.ru/unix/syscons/XWin.html"> Какое отношение это имеет к X-Window?</a> </li>
  <li><a href="https://web.archive.org/web/20190720144918/http://pascal.tsu.ru/unix/syscons/ansi.html">Команды (esc-последовательности) syscons</a> </li>
  <li><a href="https://web.archive.org/web/20190720144918/http://pascal.tsu.ru/unix/syscons/app2.html">Управляющие (&quot;контроловые&quot;) символы</a> </li>
  <li><a href="https://web.archive.org/web/20190720144918/http://pascal.tsu.ru/unix/syscons/app3.html">&quot;Функциональные&quot; клавиши</a> </li>
  <li><a href="https://web.archive.org/web/20190720144918/http://pascal.tsu.ru/unix/syscons/app4.html">Несколько мелких полезных программок.</a> </li>
</ul>
</div>
<div id="block">
<div class="title">Разное</div>
<ul>
	<li><a href="https://web.archive.org/web/20190720144918/http://pascal.tsu.ru/unix/lint/rebuild.html">Перегенерация ядра системы (kernel)</a></li>
	<li><a href="https://web.archive.org/web/20190720144918/http://pascal.tsu.ru/other/frames.html">Фреймы Ethernet.</a></li>
	<li><a href="https://web.archive.org/web/20190720144918/http://pascal.tsu.ru/other/xkb/">XKB - "клавиатурный модуль" X-Window.</a></li>
</ul>
</div>
<div id="block">
<div class="title">Мои программы</div>
<ul>
	<li><a href="other/xxkb/">Xxkb</a> (для модуля XKB)</li>
	<li><a href="other/xxkb/README">README</a> и <a href="other/xxkb/CHANGES">CHANGES</a>.</li>
</ul>
</div>
</td>

<td class="content" valign="top" align="left"><h2>Почему руссификация через XKB не работает?</h2>


      <ul>
        <li><a href="https://web.archive.org/web/20190720144918/http://pascal.tsu.ru/other/xkb/problems.html#who">Кто виноват?</a>
            <ul>
              <li><a href="https://web.archive.org/web/20190720144918/http://pascal.tsu.ru/other/xkb/problems.html#codes">Что такое &quot;русские буквы&quot;?</a> </li>
              <li><a href="https://web.archive.org/web/20190720144918/http://pascal.tsu.ru/other/xkb/problems.html#LookupString">Процедуры Xlib для преобразования кодов.</a> </li>
              <li><a href="https://web.archive.org/web/20190720144918/http://pascal.tsu.ru/other/xkb/problems.html#locale">Что значит - &quot;установить locale&quot;?</a> </li>
              <li><a href="https://web.archive.org/web/20190720144918/http://pascal.tsu.ru/other/xkb/problems.html#Xsetlocale">&quot;Иксовая&quot; setlocale().</a> </li>
              <li><a href="https://web.archive.org/web/20190720144918/http://pascal.tsu.ru/other/xkb/problems.html#programms">Программы &quot;правильные&quot; и &quot;неправильные&quot;.</a> </li>
              <li><a href="https://web.archive.org/web/20190720144918/http://pascal.tsu.ru/other/xkb/problems.html#other">Почему работают другие способы руссификации?</a> </li>
              <li><a href="https://web.archive.org/web/20190720144918/http://pascal.tsu.ru/other/xkb/problems.html#wrong">Почему иногда вводятся &quot;не те буквы&quot;?</a> </li>
            </ul>
        </li>
        <li><a href="https://web.archive.org/web/20190720144918/http://pascal.tsu.ru/other/xkb/problems.html#What">Что делать?</a>
            <ul>
              <li><a href="https://web.archive.org/web/20190720144918/http://pascal.tsu.ru/other/xkb/problems.html#What-system">Настройка системы.</a> </li>
              <li><a href="https://web.archive.org/web/20190720144918/http://pascal.tsu.ru/other/xkb/problems1.html#What-programs">Что делать с &quot;неправильными&quot; программами?</a> </li>
              <li><a href="https://web.archive.org/web/20190720144918/http://pascal.tsu.ru/other/xkb/problems1.html#hack">Методы &quot;грубого хака&quot;.</a> </li>
            </ul>
        </li>
      </ul>
      <p> К сожалению, настроить XKB с &quot;русской&quot; раскладкой клавиатуры - это еще  &quot;полдела&quot;. <br/>
        Очень часто при этом русские буквы вообще &quot;не вводятся&quot; или вводятся,  но &quot;не те&quot;, или вводятся, но &quot;не везде&quot; (не во всех программах). </p>
      <h2><a name="who" id="who">Кто виноват?</a></h2>
      <h3><a name="codes" id="codes">Что такое &quot;русские буквы&quot;?</a></h3>
      <p> Давайте не поленимся и рассмотрим проблему с самого начала. <br/>
        Под русским алфавитом в Юниксах обычно понимают кодировку <strong>KOI8-R</strong> (хотя иногда  используется <strong>iso-8859-5</strong> или &quot;вариации на тему&quot; <strong>KOI8-R - KOI8-U</strong>). <br/>
        В этой кодировке русские буквы занимают коды 0xc0-0xff (в кодах 0x40-0x7f  расположены латинские буквы). </p>
      <p> Но в этом же диапазоне могут размещаться </p>
      <ul>
        <li> буквы национальных алфавитов стран Западной Европы (буквы с &quot;шляпкой&quot;,  	&quot;тильдой&quot;, &quot;умлаутом&quot; и т.п.) </li>
        <li> греческий алфавит </li>
        <li> арабский алфавит </li>
        <li> и т.п. </li>
      </ul>
      То есть, на одно и то же место в &quot;кодовой таблице&quot; претендуют куча разных  алфавитов.
      <p> Попытки совместить весь этот &quot;зоопарк&quot; в X-Window, привели к тому, что  под код символа в раскладке клавиатуры были выделены два байта. В старшем  байте хранится некий номер определяющий charset (набор символов), а в  младшем - собственно код символа. (В общем, идея та же что и у UNICODE,  хотя это и не &quot;уникод&quot;). </p>
      <p> Кстати, &quot;кириллическому&quot; алфавиту (не обязательно &quot;русскому&quot;) достались  коды, у которых в старшем байте число 6 (признак &quot;кириллицы&quot;), а младший байт  содержит код, который совпадает, как правило, с кодом буквы в koi8-r  (хотя это и не так уж важно, как мы увидим в дальнейшем). </p>
      <p> Называются эти символы - Cyrillic_a, Cyrillic_be, Cyrillic_tse и т.д.  Обычно про них говорят - Cyrillic коды. </p>
      <p> Итак. При нажатии клавиши, когда активна &quot;русская&quot; раскладка, в программу  должны попадать двубайтные Cyrillic коды. </p>
      <p> Но проблема в том, что большинство программ внутри хранит строки  (и выдает их на экран) как цепочку байтов. То есть, двубайтные коды на входе  в программу должны быть преобразованы в однобайтные. При этом, естественно,  часть информации (принадлежность символа к конкретному национальному алфавиту)  теряется. </p>
      <h3><a name="LookupString" id="LookupString">Процедуры Xlib для преобразования кодов.</a></h3>
      <p> Для такого преобразования в <strong>Xlib</strong> существует две процедуры - <strong>XLookupString</strong> и <strong>XmbLookupString</strong> (<strong>mb</strong> означает - <strong>&quot;multi byte&quot;</strong>). В качестве аргумента  этим подпрограммам передается &quot;сообщение о нажатии&quot; (или отпускании) клавиши  (Key pss Event), а &quot;на выходе&quot; должен получаться однобайтный код символа. <br/>
        (Строго говоря, есть еще одна аналогичная процедура - <strong>XwcLookupString</strong> (<strong>wc</strong> означает - <strong>&quot;wide char&quot;</strong>). Но она используется крайне редко.) </p>
      <p> Надо отметить, что в большинстве современных программ выбор конкретной  процедуры происходит следующим образом. </p>
      <p> Процедура <strong>XLookupString</strong> более &quot;древняя&quot; и более &quot;глупая&quot;. Процедура <strong>XmbLookupString</strong> более сложная и более гибкая, но в своей работе пользуется  &quot;input context'ом&quot; текущего &quot;окна&quot;. Не вдаваясь в подробности, можно сказать,  что &quot;input context&quot; - это некий объект, описывающий особенности ввода (input)  в &quot;свое окно&quot;, и содержащий список &quot;методов&quot; для различных преобразований  входных цепочек символов. </p>
      <p> Поэтому, большинство &quot;иксовых&quot; программ пытаются создать для своих &quot;окон&quot;  input context. И, если им это удается, используют <strong>XmbLookupString</strong>,  а если по каким-то причинам input context не может быть создан, то  используют <strong>XLookupString</strong>. </p>
      <p> Так вот. Для того, чтобы избежать путаницы в алфавитах, обе эти процедуры  ориентируются на &quot;текущую locale&quot; (которая, в частности, определяет  &quot;национальный&quot; алфавит с которым в данный момент работает система). </p>
      <p> Если вы не знаете - что такое locale, могу порекомендовать сайт - <a href="https://web.archive.org/web/20190720144918/http://www.sensi.org/%7Ealec/locale/">&quot;Locale AS IS&quot;</a>,   где это об этом рассказано достаточно подробно (и по русски!). </p>
      <p> Здесь замечу только, что ... </p>
      <ul>
        <li> программы обычно узнают о текущей locale из  &quot;переменных окружения&quot; (environment) <strong>LANG</strong>, или <strong>LC_ALL, LC_CTYPE</strong> и т.п.; </li>
        <li> для каждой locale в системе существует набор файлов, в которых содержится  вся информация &quot;зависящая от языка&quot; (и, соответствено - алфавита); </li>
        <li> в системе X-Window (а ее можно рассматривать как отдельную ОС), основными  файлами, описывающим &quot;категории locale&quot; является файлы <strong>XLC_LOCALE</strong>, разложенные  по отдельным поддиректориям в директории <strong>X11R6/lib/X11/locale</strong>. Каждая  поддиректория соответствует одной конкретной locale. </li>
        <li> процедуры <strong>Xlib</strong> в своей работе используют некоторые значения (какие именно -  рассмотрим чуть позже), описанные в файле <strong>XLC_LOCALE</strong>. </li>
      </ul>
      <p> Кроме того надо заметить, что не бывает &quot;никакой locale&quot;. Если locale не  задана &quot;переменными окружения&quot; или задана, но такая, что система затрудняется  найти нужные файлы, то будет использоваться locale - &quot;<strong>C</strong>&quot;. </p>
      <p> Так вот. При старте программа должна установить нужную locale (ниже мы  поговорим об этом немного подробнее).  Библиотека <strong>Xlib</strong> найдет соответствующий файл, описывающий эту locale.  Процедуры <strong>*LookupString</strong> по этому описанию будут принимать решение - как  преобразовать двубайтные коды (в нашем случае - Cyrillic коды) в однобайтные  символы. </p>
      <p> Если заглянуть немного глубже в работу этих процедур, то можно заметить, что </p>
      <ul>
        <li> обе процедуры ориентируются на параметр locale (точнее, он назывется -  класс) - <strong>encoding_name</strong>; </li>
        <li> значение этого класса (для работы с Cyrillic) должно быть <strong>KOI8-R</strong> или <strong>ISO8859-5</strong>; </li>
        <li> в зависимости от значения этого класса...
          <ul>
              <li> если он <strong>KOI8-R</strong> - Cyrillic превращаются в однобайтные коды <strong>koi8-r</strong> </li>
            <li> если <strong>ISO8859-5</strong> - Cyrillic превращаются в коды <strong>iso8859-</strong>5 </li>
            <li> если ни то ни другое - Cyrillic вообще ни во что не преобразуется.  То есть &quot;на выход&quot; выдается строчка нулевой длины. Это и выглядит как  &quot;русские буквы не вводятся&quot;. </li>
          </ul>
        </li>
      </ul>
      (Надо отметить, что эти названия &quot;зашиты&quot; в библиотке <strong>Xlib</strong> вместе с таблицами  перекодировки. Поэтому никакими внешними файлами изменить их, или добавить  новые, нельзя.)
      <p> Кстати, если locale &quot;никакая&quot; (то есть - <strong>C</strong>), или <strong>encoding_name</strong> не определен,  то нормально вводятся коды &quot;национальных алфавитов Западной Европы&quot;, которые  занимают то же место в кодовой таблице, что и <strong>koi8-r</strong>. А если нормально  преобразуются коды Cyrillic, то наоборот - &quot;подавляется&quot; ввод  &quot;западноевропейских&quot; символов. </p>
      <p> Кроме того, есть отличия в работе двух <strong>*LookupString</strong>. </p>
      <ul>
        <li> <strong>XLookupString</strong> прежде всего пытается взять <strong>encoding_name</strong> из &quot;переменной  окружения&quot; <strong>_XKB_CHARSET</strong>. Если такая переменная есть, то используется ее  значение и locale устанавливать не нужно. </li>
        <li> <strong>XmbLookupString</strong>, напротив, не только обязательно требует правильной  locale, но и еще использует в своей работе значение двух классов - <strong>encoding_name</strong> и <strong>ct_encoding</strong> (<strong>ct - &quot;compaund text&quot;</strong>). Поэтому, для ее  нормальной работы, значения этих двух классов должно совпадать (по крайней  мере - для &quot;кириллицы&quot;). </li>
      </ul>
      <h3><a name="locale" id="locale">Что значит - &quot;установить locale&quot;?</a></h3>
      <p> Конечно, об этом лучше прочитать в man'ах или уже упомянутой <a href="https://web.archive.org/web/20190720144918/http://www.sensi.org/%7Ealec/locale/">&quot;Locale AS IS&quot;</a>. <br/>
        Но я постараюсь вкратце описать основные моменты этого действа. </p>
      <p> Во-первых, надо заметить, что существует &quot;системная&quot; locale (или  &quot;libc'ишная&quot;), которая влияет на работу процедур <strong>libc</strong>, а не &quot;иксов&quot;. </p>
      <p> В X-Window существует как бы &quot;продолжение&quot; этой locale - дополнительные  файлы, в которых описываются параметры влияющие на работу процедур из <strong>Xlib</strong>. </p>
      <p> Для того, чтобы программа &quot;настроила&quot; <strong>libc</strong> под нужную locale, она вызывает  в начале процедуру <strong>libc</strong> - <strong>setlocale()</strong>. </p>
      <p> Вызов это процедуры имеет три формы (возможно, так о них не говорят, но  мне легче будет ссылаться) </p>
      <ol>
        <li> <strong>setlocale(..., &quot;ru_RU.KOI8-R&quot;)</strong> - в вызове явно указывается - какую locale  требуется установить; </li>
        <li> <strong>setlocale(..., &quot;&quot;)</strong> - в этом случае процедура пытается взять название  соответствующей &quot;категории locale&quot; (вот что это такое, я объяснять не буду),  заданной первым аргументом, из &quot;одноименной&quot; переменной окружения; если  такой пременной нет, то из переменной окружения <strong>LANG</strong>, если и такой нет,  то locale будет &quot;никакая&quot;, то есть - <strong>&quot;C&quot;</strong>. </li>
        <li> <strong>setlocale(..., NULL)</strong> - а вот это, скорее, не &quot;<strong>set</strong>&quot;,  а &quot;<strong>get</strong>&quot;, поскольку  она ничего не устанавливает, а наоборот - возвращает название locale,  которое было установленно с помощью одной из первых двух форм вызова <strong>setlocale()</strong>. </li>
      </ol>
      <p> Итак. Для того, чтобы &quot;установить locale&quot; (&quot;libc'ишную&quot;), программа  вызывает <strong>setlocale()</strong> в первой или второй форме. Обычно используется вторая  форма, поскольку это позволяет пользователю гибко менять текущую locale  с помощью переменных окружения. </p>
      <p> Если программа &quot;иксовая&quot;, то есть использует <strong>Xlib</strong>, то при первых же вызовах  процедур <strong>Xlib</strong>, зависящих от locale, происходит настройка &quot;иксовой&quot; locale. </p>
      <p> Надо заметить, что это делается автоматически. То есть никаких дополнительных  вызовов не требуется. </p>
      <p> Соответствующие процедуры <strong>Xlib</strong> узнают название текущей &quot;libc'ишной&quot; locale  с помощью &quot;третей формы вызова&quot; <strong>setlocale()</strong> (это важно!) и по этому названию  пытаются найти соответствующий файл (<strong>XLC_LOCALE</strong>), содержащий &quot;иксовые&quot;  компоненты locale. </p>
      <p> Для этого они ищут подходящую поддиректорию в файле <strong>X11R6/lib/X11/locale/locale.dir</strong>. Если там название не находится, то сначала  пытаются &quot;подменить&quot; его с помощью файла <strong>X11R6/lib/X11/locale/locale.alias</strong>,  а потом, опять же, найти с помощью <strong>locale.dir</strong>. (Содержимое этих файлов  достаточно понятно без дополнительных пояснений.) <br/>
        Если и после этого &quot;ничего подходящего&quot; не находится, то используется  &quot;иксовая&quot; locale <strong>&quot;C&quot;</strong> (хотя &quot;libc'ишная&quot; может быть другая). </p>
      <p> Таким образом, для &quot;настройки locale&quot;, как &quot;системной&quot;, так и &quot;иксовой&quot;,  необходимо в начале программы вызвать &quot;libc'ишную&quot; процедуру <strong>setlocale()</strong>. </p>
      <p> И вот здесь есть одна тонкость... </p>
      <h3><a name="Xsetlocale" id="Xsetlocale">&quot;Иксовая&quot; setlocale().</a></h3>
      <p> Дело в том, что процедуры <strong>Xlib</strong> для того, чтобы узнать название &quot;текущей  locale&quot; используют &quot;третью форму&quot; вызова &quot;libc'ишной&quot; <strong>setlocale()</strong>. </p>
      <p> Но, на тот случай, если в &quot;системной&quot; <strong>libc</strong> нет такой процедуры, в <strong>Xlib</strong> существует &quot;заглушка&quot; - (вообще-то, она называется<strong>_Xsetlocale()</strong>), которая может  вызываться вместо системной <strong>setlocale()</strong>. </p>
      <p> Для того, чтобы работала &quot;заглушка&quot;, библиотека <strong>Xlib</strong> должна быть собрана  с &quot;опцией&quot; </p>
      <p>#define	X_LOCALE  </p>
(при этом вызовы <strong>setlocale()</strong> автоматически заменяются на вызовы <strong>_Xsetlocale()</strong>)
<p> Надо заметить, что &quot;иксовая&quot; <strong>setlocale()</strong>, хотя и вызывается точно так же,  как и &quot;системная&quot; (те же три формы вызова), имеет некоторые отличия во  &quot;второй форме&quot; (наиболее популярном способе установки &quot;текущей locale&quot;). </p>
<ul>
  <li> Категории (первый аргумент) могут быть только <strong>LC_ALL</strong> или <strong>LC_CTYPE</strong>. </li>
  <li> При этом название locale она пытается взять из переменных окружения <strong>LC_CTYPE</strong> и, если не получилось - <strong>LANG</strong>. </li>
  <li> На переменную окружения <strong>LC_ALL</strong> она внимания не обращает (даже если  первый аргумент - &quot;категория&quot; <strong>LC_ALL</strong>). </li>
</ul>
Ну и, естественно, эта &quot;заглушка&quot; устанавливает только &quot;иксовые&quot; параметры  locale, а не &quot;libc'ишные&quot;.
<p> Так вот. Проблемы могут возникнуть, если у вас в системе <strong>Xlib</strong> почему-то  собрана с &quot;опцией&quot; <strong>X_LOCALE</strong>, хотя в <strong>libc</strong> соответствующая процедура имеется. </p>
<p> Тогда вызов <strong>setlocale()</strong> из <strong>libc</strong> запомнит название locale в своих внутренних  переменных, а процедуры <strong>Xlib</strong> будут спрашивать &quot;текущую locale&quot; у своей  &quot;заглушки&quot;, которая, естественно, ее не знает. </p>
<p> Если уж у вас <strong>Xlib</strong> собрана с <strong>X_LOCALE</strong>, то и программы должны вызывать  не &quot;системную&quot; <strong>setlocale()</strong>, а &quot;иксовую&quot;. </p>
<p> Для этого перед вызовом <strong>setlocale()</strong> должно стоять </p>
<p>#define	X_LOCALE  #include &lt;X11/Xlocale.h&gt;  </p>
<p> Если <strong>Xlib</strong> &quot;нормальная&quot; (то есть ориентруется на &quot;системную&quot; <strong>setlocale</strong>),  то этих строчек не нужно. (Хотя, конечно, понадобится <strong>#include &lt;locale.h&gt;</strong>) </p>
<h3><a name="programms" id="programms">Программы &quot;правильные&quot; и &quot;неправильные&quot;.</a></h3>
<p> Итак. Можно сказать, что программы могут быть &quot;правильными&quot; и &quot;неправильными&quot;  в смысле &quot;установки locale&quot;. </p>
<p> &quot;Правильные&quot; программы вызывают в начале <strong>setlocale()</strong> и в них &quot;русские буквы  вводятся&quot; (если, конечно, у вас переменные окружения указывают на существующий  файл <strong>XLC_LOCALE</strong>). </p>
<p> &quot;Неправильные&quot; программы &quot;забывают&quot; установить текущую locale (соответствено,  в них используется locale <strong>&quot;C&quot;</strong>) и в них &quot;русские буквы НЕ вводятся&quot;  (хотя замечательно вводяться &quot;западноеворопейские&quot; буквы). </p>
<h3><a name="other" id="other">Почему работают другие способы руссификации?</a></h3>
<p> Кроме &quot;руссификации через XKB&quot; часто используются &quot;старые&quot; методы -  &quot;загрузка <strong>xmodmap</strong>&quot; и &quot;программы - переключатели клавиатуры&quot; (<strong>xruskb, xes</strong> и  т.п.). </p>
<p> В общем-то, принципиальная разница между ними в том, что ... </p>
<ul>
  <li> <strong>Xmodmap</strong> &quot;честно&quot; размещает русские буквы во второй группе таблицы символов  (при этом используются функции core protocol'а, а не XKB) и определяет клавишу -  переключатель между группами. </li>
  <li> А программы-переключатели &quot;сидят резидентом&quot; в памяти и на каждое переключение  раскладки, просто &quot;нагло&quot; переписывают первую группу таблицы символов. </li>
</ul>
<p> А общее у них то, что они в качестве русских букв используют не коды Cyrillic,  а их однобайтные аналоги. Которые, вообще-то, в X-Window отведены под символы  национальных алфавитов Западной Европы (&quot;умлауты&quot;, &quot;тильды&quot; и т.п.) </p>
<p> То есть, &quot;неправильные&quot; программы (работающие с locale <strong>&quot;C&quot;</strong>) воспринимают  их как &quot;родные&quot;. </p>
<p> Проблемы как раз возникают с &quot;правильными&quot; программами, которые выставляют  &quot;кириллическую&quot; locale. Но с ними, обычно борятся &quot;шаманскими&quot; методами -  либо устанавливают &quot;переменные окружения&quot; так, чтобы они НЕ указывали на  &quot;кириллическую&quot; locale, либо убирают из <strong>XLC_LOCALE</strong> строчку, описывающую <strong>encoding_name</strong> (именно по ней <strong>*LookupString</strong> &quot;догадываются&quot;, что допустимыми  являются только коды Cyrillic). </p>
<h3><a name="wrong" id="wrong">Почему иногда вводятся &quot;не те буквы&quot;?</a></h3>
<p> Надеюсь, вы поняли - почему бывает, что &quot;русские буквы не вводятся&quot; или  &quot;вводятся, но не везде&quot; (не вводятся, если программа - &quot;неправильная&quot;). </p>
<p> Почему же бывает, что &quot;вводятся, но не те&quot;? </p>
<p> Ну, во-первых, возможно у вас программа использует &quot;не те шрифты&quot; (<strong>fonts</strong>). <br/>
  В обычных &quot;фонтах&quot; на месте &quot;русских&quot; букв расположены &quot;западноевропейские&quot;  (которые имеют те же коды, то и русские в <strong>koi8-r</strong>). </p>
<p> Во-вторых, может быть, что у вас неправильно настроена locale (переменными  окружения). То есть, она указывает на &quot;русский&quot; <strong>XLC_LOCALE</strong>, но не для  кодировки <strong>KOI8-R</strong>, а для <strong>ISO8859-5</strong>. Такая ситуация может быть, если вы  используете &quot;сокращенное&quot; название locale (<strong>ru, ru_RU, ru_SU, russian</strong>),  которое в файле <strong>locale.alias</strong> указывает на locale <strong>&quot;ru_RU.ISO8859-5&quot;</strong>. </p>
<p> И, наконец, как это ни странно звучит, возможно, что ошибка в <strong>Xlib</strong>.  Дело в том, что в <strong>XFree86 3.3.3</strong> как-раз в <strong>Xlib</strong> содержится ошибка. Из-за  которой Cyrillic коды перекодируются в <strong>iso8859-5</strong>, если <strong>encoding_name - KOI8-R</strong> (если <strong>encoding_name ISO8859-5</strong>, то вообще ничего не получится, поскольку  они, в свою очередь, перепутаны там с Arabic). </p>
<h2><a name="What" id="What">Что делать?</a></h2>
<p> Так что же делать? <br/>
  Давайте сначала найдем хотя бы одну программу, которая работает с  &quot;XKB руссификацией&quot; правильно. Что делать с &quot;неправильными&quot; программами  решим потом. </p>
<p> Лучше всего взять программу <strong>xterm</strong>, если, конечно, она у вас из того же  &quot;комплекта&quot;, что и X-сервер. То есть собрана с &quot;текущей <strong>Xlib</strong>&quot; и с теми же  &quot;опциями&quot;, что и <strong>Xlib</strong>. </p>
<h3><a name="What-system" id="What-system">Настройка системы.</a></h3>
<p> Если у вас клавиатура уже руссифицирована каким-нибудь &quot;старым&quot; способом  (с помощью <strong>xmodmap</strong> или программ-руссификаторов <strong>xruskb, xes</strong> и т.п.),  то уберите их. Они будут только мешать. Во всяком случае, если будет  &quot;очень надо&quot;, вернете их потом. </p>
<p> Короче, позаботьтесь о том, чтобы у вас не было русского <strong>.Xmodmap</strong> в домашней директории (и/или в <strong>{XROOT}/lib/X11/xinit/</strong>) и никакие <strong>xruskb</strong> не стартовали бы автоматически при запуске &quot;иксов&quot;. </p>
<p> Итак. Прежде всего убедитесь, что у вас правильно установлены &quot;русские фонты&quot;.  Для этого нужно взять текст, &quot;набитый&quot; в <strong>koi8</strong> (например, в какой-нибудь  &quot;консольной&quot; программе). Если он нормально читается в <strong>xterm</strong>, то шрифты  установлены &quot;правильные&quot;. (Как установить &quot;кириллические&quot; шрифты я здесь  описывать не буду. В Интернете достаточно инструкций на эту тему.) </p>
<p> Дальше. Проверьте, что у вас правильно установлена locale.  Обычно она устанавливается переменной окружения <strong>LANG</strong>. Убедитесь, что  значение этой переменной указывает на существующие файлы для &quot;libc'ишной&quot;  locale (в <strong>/usr/share/locale</strong>) и &quot;иксовой&quot; locale (через <strong>locale.dir</strong> и,  если нужно, <strong>locale.alias</strong>). </p>
<p> Не полагайтесть на результаты выдачи команды <strong>locale</strong>. В некоторых  случаях она может показывать не совсем то, что и процедура <strong>setlocale()</strong> вызываемая внутри прикладных программ. </p>
<p> Если будут проблемы, можете воспользоваться моей тестовой программкой <a href="https://web.archive.org/web/20190720144918/http://pascal.tsu.ru/other/xkb/testXlc.tgz">testXlc.</a> <br/>
  Она определяет </p>
<ul>
  <li> &quot;системную&quot; locale, </li>
  <li> locale для <strong>Xlib</strong>, </li>
  <li> полный путь до файла <strong>XLC_LOCALE</strong>, </li>
  <li> значения некоторых классов &quot;иксовой&quot; locale, </li>
  <li> в том числе - <strong>&quot;encodingName&quot;</strong> (которое влияет на работу <strong>*LookupString</strong>). </li>
</ul>
<p> Для &quot;сборки&quot; этой программы надо последовательно набрать команды </p>
<p>xmkmf  make  </p>
Надо также заметить, что  эта программа использует внутренние процедуры <strong>Xlib</strong> (не предназначенные для вызова в прикладных программах). Поэтому,  нет гарантии, что она будет &quot;собираться&quot; и правильно работать во всех  версиях XFree. Во всяком случае, она должна давать требуемый результат  в версиях 3.3.2, 3.3.3, 3.3.3.1.
<p> Далее. Можно проверить, что XKB действительно переключается на &quot;русскую&quot;  раскладку и выдает коды Cyrillic. </p>
<p> Для этого можно воспользоваться программой <strong>xev</strong> (если ее нет в вашей системе,  то можно найти ее в <strong>XFree86-contrib</strong>). </p>
<p> Вообще-то, это &quot;универсальный тестер&quot; &quot;событий&quot; (X events).  Ее надо запустить из под <strong>xterm</strong>. При нажатии кнопок она должна писать что-то  вроде этого </p>
<p>Keypss event, serial 21, synthetic NO, window 0x5800001,      root 0x25, subw 0x0, time 3744190622, (533,270), root:(610,437),      state 0x2000, keycode 38 (keysym 0x6c6, <strong>Cyrillic_ef</strong>), same_screen YES,      XLookupString gives 0 characters:  &quot;&quot;    KeyRelease event, serial 21, synthetic NO, window 0x5800001,      root 0x25, subw 0x0, time 3744190755, (533,270), root:(610,437),      state 0x2000, keycode 38 (keysym 0x6c6, <strong>Cyrillic_ef</strong>), same_screen YES,      XLookupString gives 0 characters:  &quot;&quot;  </p>
<p> Обратите внимание, что если у вас клавиатура перключена в &quot;русский режим&quot;,  то в третей строчке сообщения должно быть название Cyrillic кода клавиши </p>
<p> Кстати, <strong>xev</strong> - &quot;неправильная&quot; программа. Если сделать ее &quot;правильной&quot;,  добавив в начале вызов (и &quot;пересобрав&quot; ее) </p>
<p>setlocale(LC_CTYPE, &quot;&quot;);  </p>
то она будет показывать и результат трансляции Cyrillic кодов в <strong>koi8-r</strong> (ну, или <strong>iso8859-5</strong>), например -
<p>Keypss event, serial 21, synthetic NO, window 0x5800001,      root 0x25, subw 0x0, time 3744190622, (533,270), root:(610,437),      state 0x2000, keycode 38 (keysym 0x6c6, <strong>Cyrillic_ef</strong>), same_screen YES,      XLookupString gives 1 characters:  <strong>&quot;ф&quot;</strong>    KeyRelease event, serial 21, synthetic NO, window 0x5800001,      root 0x25, subw 0x0, time 3744190755, (533,270), root:(610,437),      state 0x2000, keycode 38 (keysym 0x6c6, <strong>Cyrillic_ef</strong>), same_screen YES,      XLookupString gives 1 characters:  <strong>&quot;ф&quot;</strong>  </p>
<p> Ну и, наконец, надо убедится, что у вас не XFree86 3.3.3 (хотя с этого  надо было начинать :-). <br/>
  (Надо бы написать простенький &quot;тестер&quot;, который проверяет правильность  работы <strong>*LookupString</strong> при заведомо правильной <strong>encoding_name</strong>. Но пока сойдет  &quot;подправленная&quot; <strong>xev</strong>. Она, кстати, использует только <strong>XLookupString.</strong>) </p>
<p> Итак, если </p>
<ul>
  <li> у вас стоят &quot;кириллические&quot; шрифты; </li>
  <li> программа <strong>testXlc</strong> показала, что название &quot;системной&quot; и &quot;иксовой&quot; locale  	совпадают, и значение <strong>&quot;encodingName&quot; - KOI8-R</strong>; </li>
  <li> <strong>xev</strong> показывает Cyrillic коды; </li>
  <li> &quot;поправленный&quot; <strong>xev</strong> транслирует их в нормальные <strong>koi8-r</strong> коды; </li>
</ul>
то система у вас настроена.  И &quot;правильные&quot; программы должны работать нормально.
<p> А вот что делать с &quot;неправильными&quot; программами - разговор отдельный... </p>
<h3><a href="https://web.archive.org/web/20190720144918/http://pascal.tsu.ru/other/xkb/problems1.html">Что делать с &quot;неправильными&quot; программами?</a></h3>
<hr/>
<p> (Если мои советы вам не помогли (или есть какие-то &quot;непонятки&quot;), можете  обращаться ко мне &quot;мейлом&quot;. <br/>
  Но я не хотел бы видеть вопросы типа - &quot;я все сделал, как написано, но  все равно не работает&quot;. Будет лучше, если вы подробно напишете о проделанных  тестах и их результатах.) </p></td>
<td width="200" class="links" valign="top" align="left" style="padding-top:150px;">
 
</td>
</tr>
</table>
<div id="copyright">&copy; <a href="https://web.archive.org/web/20190720144918/mailto:pascal@tsu.ru">Иван Паскаль</a></div>
</body>
</html>
<!--
     FILE ARCHIVED ON 14:49:18 Jul 20, 2019 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 22:57:00 Aug 11, 2022.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
-->
<!--
playback timings (ms):
  captures_list: 311.604
  exclusion.robots: 0.214
  exclusion.robots.policy: 0.207
  cdx.remote: 0.065
  esindex: 0.009
  LoadShardBlock: 59.112 (3)
  PetaboxLoader3.datanode: 91.572 (4)
  CDXLines.iter: 13.289 (3)
  load_resource: 110.449
  PetaboxLoader3.resolve: 64.932
-->
